var Game=function(e){function t(t){for(var i,o,n=t[0],l=t[1],c=t[2],h=0,u=[];h<n.length;h++)o=n[h],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&u.push(a[o][0]),a[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(p&&p(t);u.length;)u.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],i=!0,n=1;n<r.length;n++){var l=r[n];0!==a[l]&&(i=!1)}i&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var i={},a={0:0},s=[];function o(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=i,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(r,i,function(t){return e[t]}.bind(null,i));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var n=window.webpackJsonpGame=window.webpackJsonpGame||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var p=l;return s.push([653,1]),r()}({1559:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=r(1560),s=r(1564),o=r(645);!function(e){e[e.CUTSCENE=0]="CUTSCENE",e[e.GAMEPLAY=1]="GAMEPLAY"}(i=t.EventType||(t.EventType={}));var n=function(){function e(e,t,r,i){this.fadingCamera=!1,this.scene=e,this.story=t,this.playerType=r,this.done=!1,this.currEventIndex=0,this.currSceneIndex=0,this.storyId=i||"",o.initLogging(this.scene),o.startGame(this.scene),this.updateEventType()}return e.prototype.start=function(){var e;switch(void 0!==this.currEventManager&&(this.currEventManager.destroy(),this.currEventManager=null),this.currEventType){case i.GAMEPLAY:e=new s.GameplayManager(this.scene,this.getCurrEvent().name,this.previousPlayerPos);break;case i.CUTSCENE:e=new a.CutsceneManager(this.scene,this.getCurrEvent().name)}return this.currEventManager=e,o.startEvent(this.scene,this.getCurrEvent()),e},e.prototype.next=function(){var e=this.getSceneAt(this.currSceneIndex);return this.previousPlayerPos=this.currEventManager.getPlayerPosition(),this.currEventIndex++,e.events.length<=this.currEventIndex?(this.done=!0,void o.endGame(this.scene)):(this.updateEventType(),this.start())},e.prototype.updateEventType=function(){switch(this.getCurrEvent().type){case"gameplay":this.currEventType=i.GAMEPLAY;break;case"cutscene":this.currEventType=i.CUTSCENE}},e.prototype.getEventAt=function(e,t){return this.story.scenes[e].events[t]},e.prototype.getSceneAt=function(e){return this.story.scenes[e]},e.prototype.getCurrScene=function(){return this.getSceneAt(this.currSceneIndex)},e.prototype.getCurrEvent=function(){return this.getEventAt(this.currSceneIndex,this.currEventIndex)},e.prototype.getCurrentEventType=function(){return this.currEventType},e.prototype.isDone=function(){return this.done},e.prototype.act=function(e,t,r){this.done||(this.currEventManager.isDone()?this.fadingCamera||(this.fadingCamera=!0,this.scene.cameras.main.fade(250,0,0,0,!1,(function(e,t){t>=1&&(o.endEvent(this.scene,this.getCurrEvent()),this.next(),this.scene.cameras.main.fadeFrom(250,0,0,0,!0,(function(e,t){t>=1&&(this.fadingCamera=!1)}),this))}),this)):this.currEventManager.act(e,t,r))},e.prototype.sendCurrEvent=function(e){var t=new XMLHttpRequest;t.open("PUT","/"+this.storyId),t.setRequestHeader("Content-Type","application/json;charset=UTF-8");var r={currEvent:e};t.send(JSON.stringify(r))},e}();t.StoryManager=n},1560:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,a,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return o},n=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var l=r(640),c=r(235),p=r(236),h=r(1562),u=r(1563),d=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.actions=[],i.actors=[],i.populateActors(),i.currActionIndex=0,i.instantiateActions(),i}return a(t,e),t.prototype.act=function(e,t,r){this.currActionIndex<this.actions.length&&this.actions[this.currActionIndex].isDone()&&this.currActionIndex++,this.sortActorDepths(),this.currActionIndex<this.actions.length?(this.actions[this.currActionIndex].act(e,t,r),this.currFocusedActor=this.actions[this.currActionIndex].getActor()):this.done=!0},t.prototype.populateActors=function(){var e,t,r=this.jsonObj.actors,i=this.scene.cache.json.get("actors").actors,a=function(e){var t=i.find((function(t){return t.id==e.actorId})),r=e.start[0],a=e.start[1];o.addActor(new p.Actor(o.scene,r,a,t))},o=this;try{for(var n=s(r),l=n.next();!l.done;l=n.next()){a(l.value)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t.prototype.addActor=function(e){this.scene.setActorCollisionsWithMap(e),this.actors.push(e)},t.prototype.getActorById=function(e){return this.actors.find((function(t){return t.getId()===e}))},t.prototype.instantiateActions=function(){var e,t,r=this.jsonObj.actions;try{for(var i=s(r),a=i.next();!a.done;a=i.next()){var o=a.value,n=this.getActorById(o.actorId);switch(o.action){case"walk":this.actions.push(new h.Walk(this.scene,n,o.arguments.x,o.arguments.y));break;case"talk":this.actions.push(new u.Talk(this.scene,n,[{author:o.arguments.author,text:o.arguments.text}]))}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype.getPlayerPosition=function(){return{x:this.currFocusedActor.getX(),y:this.currFocusedActor.getY()}},t.prototype.destroy=function(){var e,t;try{for(var r=s(this.actors),i=r.next();!i.done;i=r.next()){i.value.destroy()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.sortActorDepths=function(){var e,t,r=n(this.actors);r.sort((function(e,t){return e.getY()-t.getY()}));var i=c.GameScene.MIN_DEPTH;try{for(var a=s(r),o=a.next();!o.done;o=a.next()){o.value.setDepth(i),i++}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}},t}(l.EventManager);t.CutsceneManager=d},1561:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toRealMapCoordinates=function(e,t,r){var i={x:0,y:0};return i.x=(e+.5)*r.tileWidth,i.y=(t+1)*r.tileHeight,i},t.toTileMapCoordinates=function(e,t,r){var i={x:0,y:0};return i.x=e/r.tileWidth-.5,i.y=t/r.tileHeight-1,i}},1562:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,r,i,a){var s=e.call(this,t,r)||this;return s.x=i,s.y=a,s.started=!1,s.emitter=new Phaser.Events.EventEmitter,s.emitter.on("stopWalking",s.stopWalkingHandler,s),s}return a(t,e),t.prototype.act=function(e,t,r){this.started||(this.started=!0,this.playWalkingAnimation(),this.actor.moveAuto(this.scene,this.x,this.y,this.emitter),this.actor.getCameraToFollow(this.scene))},t.prototype.playWalkingAnimation=function(){0!=this.x?this.x<0?this.actor.playAnimation("left"):this.actor.playAnimation("right"):0!=this.y&&(this.y<0?this.actor.playAnimation("up"):this.actor.playAnimation("down"))},t.prototype.stopWalkingHandler=function(){this.actor.stopAnimation(),this.done=!0},t}(r(642).Action);t.Walk=s},1563:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,r,i){var a=e.call(this,t,r)||this;return a.onScreen=!1,a.dialogue=i,a.actor=r,a.emitter=new Phaser.Events.EventEmitter,a.emitter.on("dialogueEnded",a.dialogueEnded,a),a}return a(t,e),t.prototype.act=function(e,t,r){if(!this.onScreen)return this.actor.getCameraToFollow(this.scene),this.onScreen=!0,this.scene.scene.wake("Dialogue"),void this.scene.scene.launch("Dialogue",{dialogue:this.dialogue,emitter:this.emitter})},t.prototype.dialogueEnded=function(){this.scene.scene.sleep("Dialogue"),this.done=!0},t}(r(642).Action);t.Talk=s},1564:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,a,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return o},n=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var l=r(640),c=r(235),p=r(1565),h=r(1567),u=r(644),d=r(645),f=function(e){function t(t,r,i){var a=e.call(this,t,r)||this;return a.npcs=[],a.previousPlayerPos=i,a.flags=a.initFlags(),a.populateActors(),a.interacting=!1,a.endCondition=a.jsonObj.endEventCondition,a.emitter=new Phaser.Events.EventEmitter,a.emitter.on("dialogueEnded",a.interactionEnded,a),a}return a(t,e),t.prototype.act=function(e,t,r){this.checkForEnd()?this.done=!0:(this.sortActorDepths(),this.checkForPossibleInteraction(),this.interacting?this.player.move([]):r.includes(c.GameScene.interactKey)&&void 0!==this.interactableObj?(this.interacting=!0,this.scene.scene.wake("Dialogue"),this.scene.scene.launch("Dialogue",{dialogue:this.interactableObj.dialogue,emitter:this.emitter})):this.player.move(r))},t.prototype.populateActors=function(){var e,t,r=this.scene.cache.json.get("actors").actors;this.initPlayer(r);var i=this.jsonObj.npcs,a=function(e){var t=r.find((function(t){return t.id==e.actorId})),i=e.position[0],a=e.position[1],s=new h.Npc(o.scene,i,a,t,e,o.flags);o.addNpc(s)},o=this;try{for(var n=s(i),l=n.next();!l.done;l=n.next()){a(l.value)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t.prototype.interactionEnded=function(){this.scene.scene.sleep("Dialogue"),this.interacting=!1,this.implementFlagChanges(this.interactableObj.getFlagsChangesAfterInteraction()),this.interactableObj=void 0,this.checkForPossibleInteraction()},t.prototype.checkForEnd=function(){var e=u.boolean(this.endCondition,this.flags);return!(e instanceof Error)&&e},t.prototype.initFlags=function(){var e,t,r=new Map;try{for(var i=s(this.jsonObj.flags),a=i.next();!a.done;a=i.next()){var o=a.value;r.set(o.name,o.value)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},t.prototype.implementFlagChanges=function(e){var t,r;try{for(var i=s(e),a=i.next();!a.done;a=i.next()){var o=a.value,n=void 0;"number"==typeof this.flags.get(o.name)?n=u.number(o.value,this.flags):"boolean"==typeof this.flags.get(o.name)&&(n=u.boolean(o.value,this.flags)),n instanceof Error?console.error("Error in flag changes of interactable\n"+n.message):this.flags.set(o.name,n)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}d.flagChange(this.scene,this.flags)},t.prototype.sortActorDepths=function(){var e,t,r=n(this.npcs);r.push(this.player),r.sort((function(e,t){return e.getY()-t.getY()}));var i=c.GameScene.MIN_DEPTH;try{for(var a=s(r),o=a.next();!o.done;o=a.next()){o.value.setDepth(i),i++}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}},t.prototype.addNpc=function(e){this.setCollisionsWithAllActors(e),this.scene.setActorCollisionsWithMap(e),this.npcs.push(e)},t.prototype.setCollisionsWithAllActors=function(e){var t,r;void 0!==this.player&&this.player!==e&&e.setCollisionWith(this.player,this.scene);try{for(var i=s(this.npcs),a=i.next();!a.done;a=i.next()){var o=a.value;e.setCollisionWith(o,this.scene)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.checkForPossibleInteraction=function(){var e,t;try{for(var r=s(this.npcs),i=r.next();!i.done;i=r.next()){var a=i.value;a.setInteractable(this.flags),a.isInteractable()&&(a.isPlayerInZone(this.scene,this.player)?this.interacting?a.setActionBoxVisiblity(!1):void 0===this.interactableObj&&(this.interactableObj=a,a.setActionBoxVisiblity(!0)):this.interactableObj===a&&(a.setActionBoxVisiblity(!1),this.interactableObj=void 0),a.setPlayerInZone(!1))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.initPlayer=function(e){var t,r,i,a=this,s=e.find((function(e){return e.id==a.jsonObj.player.actorId}));return"current"==this.jsonObj.player.startPosition?null==this.previousPlayerPos?(t=0,r=0,i=new p.Player(this.scene,t,r,s,!1)):(t=this.previousPlayerPos.x,r=this.previousPlayerPos.y,i=new p.Player(this.scene,t,r,s,!0)):(t=this.jsonObj.player.startPosition[0],r=this.jsonObj.player.startPosition[1],i=new p.Player(this.scene,t,r,s,!1)),this.player=i,this.setCollisionsWithAllActors(i),this.scene.setActorCollisionsWithMap(i),i.getCameraToFollow(this.scene),i},t.prototype.getPlayerPosition=function(){return{x:this.player.getX(),y:this.player.getY()}},t.prototype.destroy=function(){var e,t;this.player.destroy();try{for(var r=s(this.npcs),i=r.next();!i.done;i=r.next()){i.value.destroy()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t}(l.EventManager);t.GameplayManager=f},1565:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r(236),o=r(1566),n=r(641),l=function(e){function t(t,r,i,a,s){return e.call(this,t,r,i,a,s)||this}return a(t,e),t.prototype.move=function(e){var t,r=Phaser.Input.Keyboard;n.isArcadeBody(this.sprite.body)&&(t=this.sprite.body),t.setVelocity(0),o.isKeyPressed(e,r.KeyCodes.DOWN)&&t.setVelocityY(this.velocity),o.isKeyPressed(e,r.KeyCodes.UP)&&t.setVelocityY(-1*this.velocity),o.isKeyPressed(e,r.KeyCodes.LEFT)&&t.setVelocityX(-1*this.velocity),o.isKeyPressed(e,r.KeyCodes.RIGHT)&&t.setVelocityX(this.velocity),0!=t.velocity.x?t.velocity.x<0?this.sprite.anims.play(this.getAnimationKey("left"),!0):this.sprite.anims.play(this.getAnimationKey("right"),!0):0!=t.velocity.y?t.velocity.y<0?this.sprite.anims.play(this.getAnimationKey("up"),!0):this.sprite.anims.play(this.getAnimationKey("down"),!0):this.sprite.anims.stop()},t}(s.Actor);t.Player=l},1566:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKeyPressed=function(e,t){return void 0!==e.find((function(e){return e.keyCode==t}))}},1567:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=r(236),n=r(643),l=r(644),c=r(355),p=function(e){function t(t,r,i,a,s,o,l){var c=e.call(this,t,r,i,a,l)||this;return c.sprite.body.setImmovable(),c.interactableCondition=s.isInteractableConditions,c.dialogue=c.getDialogue(t,s.dialogue),c.flagsChangesAfterInteraction=s.flagChangesAfterInteraction,c.setInteractable(o),c.createInteractZone(t),c.playerInZone=!1,c.actionBox=new n.ActionBox(t,"Talk",c.getX(),c.getY()-c.sprite.height,!0),c}return a(t,e),t.prototype.instantiateDialogue=function(e){this.dialogue=e},t.prototype.setInteractable=function(e){var t=l.boolean(this.interactableCondition,e);if(t instanceof Error)return console.error("Error in isInteractable flags of npc "+this.id+"\n"+t.message),void(this.interactable=!1);this.interactable=t},t.prototype.isInteractable=function(){return this.interactable},t.prototype.getFlagsChangesAfterInteraction=function(){return this.flagsChangesAfterInteraction},t.prototype.isPlayerInZone=function(e,t){return t.isOverlappingWithObject(e,this.interactZone)},t.prototype.setPlayerInZone=function(e){this.playerInZone=e},t.prototype.setActionBoxVisiblity=function(e){e?this.actionBox.show():this.actionBox.hide()},t.prototype.destroy=function(){this.sprite.destroy(),this.interactZone.destroy(),this.actionBox.destroy()},t.prototype.createInteractZone=function(e){var t=Phaser.GameObjects.Zone,r=this.sprite.width+e.getMap().tileWidth,i=2*e.getMap().tileHeight,a=this.sprite.body,s=this.sprite.x-this.sprite.width/2+a.offset.x+a.width/2,o=this.sprite.y-this.sprite.height+a.offset.y+a.height/2;this.interactZone=new t(e,s,o,r,i),e.physics.add.existing(this.interactZone)},t.prototype.getDialogue=function(e,t){var r,i,a=[],o=c.getAssetIdFromPath(t),n=e.cache.json.get(o);try{for(var l=s(n.lines),p=l.next();!p.done;p=l.next()){var h=p.value,u={author:h.author,text:h.text};a.push(u)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return a},t}(o.Actor);t.Npc=p},1570:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(a,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function n(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,n)}l((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function n(s){return function(n){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(a=2&s[0]?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,n])}}},n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var l=r(57),c=r(1571),p=r(355),h=r(355),u={key:"BootScene"},d=p.storyPath+"overall_narrative.json",f=p.storyPath+"actors.json",m=p.tilesetPath+"tilesets.json",v=p.uiPath+"text-box.png",y=p.uiPath+"text-box-big.png",g=p.uiPath+"dialogue-arrow.png",b=p.uiPath+"ZKey.png",P=p.uiPath+"loading.png",E=function(e){function r(){var t=e.call(this,u)||this;return t.fileValidations=[],t.loadedFiles=[],t.firstLoad=!0,t}return a(r,e),r.prototype.preload=function(){this.load.spritesheet("loading",P,{frameWidth:288,frameHeight:130})},r.prototype.create=function(){return s(this,void 0,void 0,(function(){var e=this;return o(this,(function(r){return this.anims.create({key:"loadingAnimation",frames:this.anims.generateFrameNumbers("loading",{frames:[0,1,2,3]}),frameRate:4,repeat:-1}),this.add.sprite(this.cameras.main.centerX,this.cameras.main.centerY,"loading",0).setOrigin(.5,.5).anims.play("loadingAnimation"),this.loadFirstFiles(),this.load.start(),this.load.on("complete",(function(){return s(e,void 0,void 0,(function(){var e,r,i;return o(this,(function(a){switch(a.label){case 0:return this.firstLoad?(this.firstLoad=!1,[4,this.areMainStoryFilesValid()]):[3,7];case 1:if(!a.sent())return[2];if(this.playerType=this.registry.get("playerType"),!this.isPlayerTypeValid(this.playerType))return[2];e=void 0;try{e=this.getStory()}catch(e){return[2]}return r=e,[3,6];case 2:return a.trys.push([2,4,,5]),[4,this.sendDebugInfo(e.graph)];case 3:return a.sent(),[3,5];case 4:return(i=a.sent())&&this.writeErrorToConsole(JSON.stringify(i),"connection"),[3,5];case 5:this.registry.set("storyId",t.storyId),r=e.story,a.label=6;case 6:return this.registry.set("story",r),this.loadAllEventFiles(r),this.load.start(),[2];case 7:return[4,Promise.all(this.fileValidations)];case 8:return a.sent().includes(!1)||this.scene.start("Tutorial"),[2]}}))}))})),[2]}))}))},r.prototype.loadFirstFiles=function(){this.load.json("overall_narrative",d),this.load.json("actors",f),this.load.json("tilesets",m),this.load.image("dialogue_box",v),this.load.image("dialogue_arrow",g),this.load.spritesheet("zkey",b,{frameWidth:16,frameHeight:15}),this.load.image("dialogue_box_big",y),this.load.rexWebFont({custom:{families:["MatchupPro","EquipmentPro"],urls:["assets/fonts/fonts.css"]}})},r.prototype.getStory=function(){var e=this.cache.json.get("overall_narrative"),t=c.createStoryLine(this.playerType,e,!1);if(void 0!==t.error)throw t;return t},r.prototype.loadAllEventFiles=function(e){var t,r,i,a;try{for(var s=n(e.scenes),o=s.next();!o.done;o=s.next()){var l=o.value;this.loadMap(l.name,l.map);try{for(var c=(i=void 0,n(l.events)),p=c.next();!p.done;p=c.next()){var h=p.value;"cutscene"===h.type?this.loadCutsceneFiles(h.name,h.name+".json"):"gameplay"===h.type&&this.loadGameplayFiles(h.name,h.name+".json")}}catch(e){i={error:e}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}},r.prototype.loadCutsceneFiles=function(e,t){this.loadedFiles.includes(e)||(this.loadedFiles.push(e),this.load.json(e,p.eventsPath+t).on("filecomplete",(function(t){return s(this,void 0,void 0,(function(){var r,i,a,s,l,c,p,h,u;return o(this,(function(o){switch(o.label){case 0:return t!==e?[3,2]:(r=this.validateFile(e,"cutscene",e),this.fileValidations.push(r),[4,r]);case 1:if(!o.sent())return[2];i=this.cache.json.get(e),a=this.cache.json.get("actors"),s=this.cache.json.get("tilesets");try{for(l=n(i.actors),c=l.next();!c.done;c=l.next())p=c.value,this.loadActorTileset(a,s,p.actorId)}catch(e){h={error:e}}finally{try{c&&!c.done&&(u=l.return)&&u.call(l)}finally{if(h)throw h.error}}o.label=2;case 2:return[2]}}))}))}),this))},r.prototype.loadGameplayFiles=function(e,t){this.loadedFiles.includes(e)||(this.loadedFiles.push(e),this.load.json(e,p.eventsPath+t).on("filecomplete",(function(t){return s(this,void 0,void 0,(function(){var r,i,a,s,l,c,p,h,u;return o(this,(function(o){switch(o.label){case 0:return t!==e?[3,2]:(r=this.validateFile(e,"gameplay",e),this.fileValidations.push(r),[4,r]);case 1:if(!o.sent())return[2];i=this.cache.json.get(e),a=this.cache.json.get("actors"),s=this.cache.json.get("tilesets"),this.loadActorTileset(a,s,i.player.actorId);try{for(l=n(i.npcs),c=l.next();!c.done;c=l.next())p=c.value,this.loadActorTileset(a,s,p.actorId),this.loadDialogue(p.dialogue)}catch(e){h={error:e}}finally{try{c&&!c.done&&(u=l.return)&&u.call(l)}finally{if(h)throw h.error}}o.label=2;case 2:return[2]}}))}))}),this))},r.prototype.loadMap=function(e,t){this.loadedFiles.includes(e)||(this.loadedFiles.push(e),this.load.tilemapTiledJSON(e,p.mapsPath+t),this.load.json(e+"_json",p.mapsPath+t).on("filecomplete",(function(t){var r,i;if(t===e+"_json"){var a=this.cache.json.get(e+"_json");try{for(var s=n(a.tilesets),o=s.next();!o.done;o=s.next()){var l=o.value,c=p.mapTilesPath+p.getFilenameFromPath(l.image);this.load.image(l.name,c)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}}),this))},r.prototype.loadActorTileset=function(e,t,r){var i=e.actors.find((function(e){return e.id==r})).tilesetId;if(!this.loadedFiles.includes(i)){this.loadedFiles.push(i);var a=t.find((function(e){return e.id==i}));this.load.spritesheet(i,p.tilesetPath+a.filename,{frameWidth:a.frameWidth,frameHeight:a.frameHeight})}},r.prototype.loadDialogue=function(e){var t=h.getAssetIdFromPath(e);this.loadedFiles.includes(t)||(this.loadedFiles.push(t),this.load.json(t,p.dialoguePath+e).on("filecomplete",(function(e){return s(this,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return e!==t?[3,2]:(r=this.validateFile(t,"dialogue",t),this.fileValidations.push(r),[4,r]);case 1:if(!i.sent())return[2];i.label=2;case 2:return[2]}}))}))}),this))},r.prototype.validateFile=function(e,t,r){var i=this.cache.json.get(r);this.writeErrorToConsole;return new Promise((function(e,r){try{e("valid"===c.validateNarrativeFile(t,i))}catch(e){r(e)}}))},r.prototype.isPlayerTypeValid=function(e){return"valid"===c.validateNarrativeFile("player-profile",e)},r.prototype.areMainStoryFilesValid=function(){var e=[this.validateFile("actors","actors","actors"),this.validateFile("tilesets","tilesets","tilesets")];return Promise.all(e).then((function(e){return!e.includes(!1)})).catch((function(e){0}))},r.prototype.sendDebugInfo=function(e){var r=document.getElementById("storyViewLink"),i=new XMLHttpRequest,a=this.playerType;return new Promise((function(s,o){i.open("POST",STORYVIEWER_URL+"/debug"),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.responseType="json";var n={playerType:a,graph:e,id:t.storyId};i.send(JSON.stringify(n)),i.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&(200===this.status?(t.storyId=i.response.id,r.disabled=!1,s()):o(i.response))}}))},r.prototype.writeErrorToConsole=function(e,t){var r;"graph"==t?(r=document.getElementById("graph-error"),console.log(e)):"connection"==t?r=document.getElementById("connection-error"):(r=document.getElementById("general-error"),console.log(e)),r.style.display="block"},r}(l.Scene);t.BootScene=E},1571:function(e,t,r){window,e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";function i(e,t,r){var i=r?" !== ":" === ",a=r?" || ":" && ",s=r?"!":"",o=r?"":"!";switch(e){case"null":return t+i+"null";case"array":return s+"Array.isArray("+t+")";case"object":return"("+s+t+a+"typeof "+t+i+'"object"'+a+o+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+i+'"number"'+a+o+"("+t+" % 1)"+a+t+i+t+")";default:return"typeof "+t+i+'"'+e+'"'}}e.exports={copy:function(e,t){for(var r in t=t||{},e)t[r]=e[r];return t},checkDataType:i,checkDataTypes:function(e,t){switch(e.length){case 1:return i(e[0],t,!0);default:var r="",a=s(e);for(var o in a.array&&a.object&&(r=a.null?"(":"(!"+t+" || ",r+="typeof "+t+' !== "object")',delete a.null,delete a.array,delete a.object),a.number&&delete a.integer,a)r+=(r?" && ":"")+i(o,t,!0);return r}},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var r=[],i=0;i<t.length;i++){var s=t[i];(a[s]||"array"===e&&"array"===s)&&(r[r.length]=s)}if(r.length)return r}else{if(a[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:s,getProperty:l,escapeQuotes:c,equal:r(2),ucs2length:r(17),varOccurences:function(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},cleanUpCode:function(e){return e.replace(p,"").replace(h,"").replace(u,"if (!($1))")},finalCleanUpCode:function(e,t){var r=e.match(d);return r&&2==r.length&&(e=t?e.replace(m,"").replace(v,"return data;"):e.replace(f,"").replace("return errors === 0;","validate.errors = null; return true;")),(r=e.match(y))&&3===r.length?e.replace(g,""):e},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var i in e)if(i!=r&&t[i])return!0},schemaUnknownRules:function(e,t){if("boolean"!=typeof e)for(var r in e)if(!t[r])return r},toQuotedString:b,getPathExpr:function(e,t,r,i){return x(e,r?"'/' + "+t+(i?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):i?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,r){return x(e,b(r?"/"+w(t):l(t)))},getData:function(e,t,r){var i,a,s,o;if(""===e)return"rootData";if("/"==e[0]){if(!P.test(e))throw new Error("Invalid JSON-pointer: "+e);a=e,s="rootData"}else{if(!(o=e.match(E)))throw new Error("Invalid JSON-pointer: "+e);if(i=+o[1],"#"==(a=o[2])){if(i>=t)throw new Error("Cannot access property/index "+i+" levels up, current level is "+t);return r[t-i]}if(i>t)throw new Error("Cannot access data "+i+" levels up, current level is "+t);if(s="data"+(t-i||""),!a)return s}for(var n=s,c=a.split("/"),p=0;p<c.length;p++){var h=c[p];h&&(n+=" && "+(s+=l(_(h))))}return n},unescapeFragment:function(e){return _(decodeURIComponent(e))},unescapeJsonPointer:_,escapeFragment:function(e){return encodeURIComponent(w(e))},escapeJsonPointer:w};var a=s(["string","number","integer","boolean","null"]);function s(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var o=/^[a-z$_][a-z$_0-9]*$/i,n=/'|\\/g;function l(e){return"number"==typeof e?"["+e+"]":o.test(e)?"."+e:"['"+c(e)+"']"}function c(e){return e.replace(n,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}var p=/else\s*{\s*}/g,h=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,u=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g,d=/[^v.]errors/g,f=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,m=/var errors = 0;|var vErrors = null;/g,v=/if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,y=/[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,g=/if \(rootData === undefined\) rootData = data;/;function b(e){return"'"+c(e)+"'"}var P=/^\/(?:[^~]|~0|~1)*$/,E=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function x(e,t){return'""'==e?t:(e+" + "+t).replace(/' \+ '/g,"")}function w(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function _(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},function(e,t,r){"use strict";var i=r(16),a=r(2),s=r(0),o=r(4),n=r(18);function l(e,t,r){var i=this._refs[r];if("string"==typeof i){if(!this._refs[i])return l.call(this,e,t,i);i=this._refs[i]}if((i=i||this._schemas[r])instanceof o)return f(i.schema,this._opts.inlineRefs)?i.schema:i.validate||this._compile(i);var a,s,n,p=c.call(this,t,r);return p&&(a=p.schema,t=p.root,n=p.baseId),a instanceof o?s=a.validate||e.call(this,a.schema,t,void 0,n):void 0!==a&&(s=f(a,this._opts.inlineRefs)?a:e.call(this,a,t,void 0,n)),s}function c(e,t){var r=i.parse(t),a=v(r),s=m(this._getId(e.schema));if(0===Object.keys(e.schema).length||a!==s){var n=g(a),l=this._refs[n];if("string"==typeof l)return p.call(this,e,l,r);if(l instanceof o)l.validate||this._compile(l),e=l;else{if(!((l=this._schemas[n])instanceof o))return;if(l.validate||this._compile(l),n==g(t))return{schema:l,root:e,baseId:s};e=l}if(!e.schema)return;s=m(this._getId(e.schema))}return u.call(this,r,s,e.schema,e)}function p(e,t,r){var i=c.call(this,e,t);if(i){var a=i.schema,s=i.baseId;e=i.root;var o=this._getId(a);return o&&(s=b(s,o)),u.call(this,r,s,a,e)}}e.exports=l,l.normalizeId=g,l.fullPath=m,l.url=b,l.ids=function(e){var t=g(this._getId(e)),r={"":t},o={"":m(t,!1)},l={},c=this;return n(e,{allKeys:!0},(function(e,t,n,p,h,u,d){if(""!==t){var f=c._getId(e),m=r[p],v=o[p]+"/"+h;if(void 0!==d&&(v+="/"+("number"==typeof d?d:s.escapeFragment(d))),"string"==typeof f){f=m=g(m?i.resolve(m,f):f);var y=c._refs[f];if("string"==typeof y&&(y=c._refs[y]),y&&y.schema){if(!a(e,y.schema))throw new Error('id "'+f+'" resolves to more than one schema')}else if(f!=g(v))if("#"==f[0]){if(l[f]&&!a(e,l[f]))throw new Error('id "'+f+'" resolves to more than one schema');l[f]=e}else c._refs[f]=v}r[t]=m,o[t]=v}})),l},l.inlineRef=f,l.schema=c;var h=s.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function u(e,t,r,i){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var a=e.fragment.split("/"),o=1;o<a.length;o++){var n=a[o];if(n){if(void 0===(r=r[n=s.unescapeFragment(n)]))break;var l;if(!h[n]&&((l=this._getId(r))&&(t=b(t,l)),r.$ref)){var p=b(t,r.$ref),u=c.call(this,i,p);u&&(r=u.schema,i=u.root,t=u.baseId)}}}return void 0!==r&&r!==i.schema?{schema:r,root:i,baseId:t}:void 0}}var d=s.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function f(e,t){return!1!==t&&(void 0===t||!0===t?function e(t){var r;if(Array.isArray(t)){for(var i=0;i<t.length;i++)if("object"==typeof(r=t[i])&&!e(r))return!1}else for(var a in t){if("$ref"==a)return!1;if("object"==typeof(r=t[a])&&!e(r))return!1}return!0}(e):t?function e(t){var r,i=0;if(Array.isArray(t)){for(var a=0;a<t.length;a++)if("object"==typeof(r=t[a])&&(i+=e(r)),i==1/0)return 1/0}else for(var s in t){if("$ref"==s)return 1/0;if(d[s])i++;else if("object"==typeof(r=t[s])&&(i+=e(r)+1),i==1/0)return 1/0}return i}(e)<=t:void 0)}function m(e,t){return!1!==t&&(e=g(e)),v(i.parse(e))}function v(e){return i.serialize(e).split("#")[0]+"#"}var y=/#\/?$/;function g(e){return e?e.replace(y,""):""}function b(e,t){return t=g(t),i.resolve(e,t)}},function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var i,a,s;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(a=i;0!=a--;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(a=i;0!=a--;)if(!Object.prototype.hasOwnProperty.call(r,s[a]))return!1;for(a=i;0!=a--;){var o=s[a];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}},function(e,t,r){"use strict";var i=r(1);function a(e,t,r){this.message=r||a.message(e,t),this.missingRef=i.url(e,t),this.missingSchema=i.normalizeId(i.fullPath(this.missingRef))}function s(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:s((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:s(a)},a.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},function(e,t,r){"use strict";var i=r(0);e.exports=function(e){i.copy(e,this)}},function(e,t,r){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,i="boolean"==typeof t.cycles&&t.cycles,a=t.cmp&&(r=t.cmp,function(e){return function(t,i){var a={key:t,value:e[t]},s={key:i,value:e[i]};return r(a,s)}}),s=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var r,o;if(Array.isArray(t)){for(o="[",r=0;r<t.length;r++)r&&(o+=","),o+=e(t[r])||"null";return o+"]"}if(null===t)return"null";if(-1!==s.indexOf(t)){if(i)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var n=s.push(t)-1,l=Object.keys(t).sort(a&&a(t));for(o="",r=0;r<l.length;r++){var c=l[r],p=e(t[c]);p&&(o&&(o+=","),o+=JSON.stringify(c)+":"+p)}return s.splice(n,1),"{"+o+"}"}}(e)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i="",a=!0===e.schema.$async,s=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var n=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(n){var l="unknown keyword: "+n;if("log"!==e.opts.strictKeywords)throw new Error(l);e.logger.warn(l)}}if(e.isTop&&(i+=" var validate = ",a&&(e.async=!0,i+="async "),i+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(i+=" /*# sourceURL="+o+" */ ")),"boolean"==typeof e.schema||!s&&!e.schema.$ref){var c=e.level,p=e.dataLevel,h=e.schema["false schema"],u=e.schemaPath+e.util.getProperty("false schema"),d=e.errSchemaPath+"/false schema",f=!e.opts.allErrors,m="data"+(p||""),v="valid"+c;if(!1===e.schema){e.isTop?f=!0:i+=" var "+v+" = false; ",(H=H||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'boolean schema is false' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),i+=" } "):i+=" {} ";var y=i;i=H.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?i+=a?" return data; ":" validate.errors = null; return true; ":i+=" var "+v+" = true; ";return e.isTop&&(i+=" }; return validate; "),i}if(e.isTop){var g=e.isTop;if(c=e.level=0,p=e.dataLevel=0,m="data",e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var b="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}i+=" var vErrors = null; ",i+=" var errors = 0;     ",i+=" if (rootData === undefined) rootData = data; "}else{if(c=e.level,m="data"+((p=e.dataLevel)||""),o&&(e.baseId=e.resolve.url(e.baseId,o)),a&&!e.async)throw new Error("async schema in sync schema");i+=" var errs_"+c+" = errors;"}v="valid"+c,f=!e.opts.allErrors;var P="",E="",x=e.schema.type,w=Array.isArray(x);if(x&&e.opts.nullable&&!0===e.schema.nullable&&(w?-1==x.indexOf("null")&&(x=x.concat("null")):"null"!=x&&(x=[x,"null"],w=!0)),w&&1==x.length&&(x=x[0],w=!1),e.schema.$ref&&s){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(s=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(i+=" "+e.RULES.all.$comment.code(e,"$comment")),x){if(e.opts.coerceTypes)var _=e.util.coerceToTypes(e.opts.coerceTypes,x);var S=e.RULES.types[x];if(_||w||!0===S||S&&!Y(S)){u=e.schemaPath+".type",d=e.errSchemaPath+"/type",u=e.schemaPath+".type",d=e.errSchemaPath+"/type";var $=w?"checkDataTypes":"checkDataType";if(i+=" if ("+e.util[$](x,m,!0)+") { ",_){var j="dataType"+c,A="coerced"+c;i+=" var "+j+" = typeof "+m+"; ","array"==e.opts.coerceTypes&&(i+=" if ("+j+" == 'object' && Array.isArray("+m+")) "+j+" = 'array'; "),i+=" var "+A+" = undefined; ";var T="",I=_;if(I)for(var O,F=-1,k=I.length-1;F<k;)O=I[F+=1],F&&(i+=" if ("+A+" === undefined) { ",T+="}"),"array"==e.opts.coerceTypes&&"array"!=O&&(i+=" if ("+j+" == 'array' && "+m+".length == 1) { "+A+" = "+m+" = "+m+"[0]; "+j+" = typeof "+m+";  } "),"string"==O?i+=" if ("+j+" == 'number' || "+j+" == 'boolean') "+A+" = '' + "+m+"; else if ("+m+" === null) "+A+" = ''; ":"number"==O||"integer"==O?(i+=" if ("+j+" == 'boolean' || "+m+" === null || ("+j+" == 'string' && "+m+" && "+m+" == +"+m+" ","integer"==O&&(i+=" && !("+m+" % 1)"),i+=")) "+A+" = +"+m+"; "):"boolean"==O?i+=" if ("+m+" === 'false' || "+m+" === 0 || "+m+" === null) "+A+" = false; else if ("+m+" === 'true' || "+m+" === 1) "+A+" = true; ":"null"==O?i+=" if ("+m+" === '' || "+m+" === 0 || "+m+" === false) "+A+" = null; ":"array"==e.opts.coerceTypes&&"array"==O&&(i+=" if ("+j+" == 'string' || "+j+" == 'number' || "+j+" == 'boolean' || "+m+" == null) "+A+" = ["+m+"]; ");i+=" "+T+" if ("+A+" === undefined) {   ",(H=H||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { type: '",i+=w?""+x.join(","):""+x,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=w?""+x.join(","):""+x,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),i+=" } "):i+=" {} ",y=i,i=H.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else {  ";var D=p?"data"+(p-1||""):"parentData";i+=" "+m+" = "+A+"; ",p||(i+="if ("+D+" !== undefined)"),i+=" "+D+"["+(p?e.dataPathArr[p]:"parentDataProperty")+"] = "+A+"; } "}else(H=H||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { type: '",i+=w?""+x.join(","):""+x,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=w?""+x.join(","):""+x,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),i+=" } "):i+=" {} ",y=i,i=H.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";i+=" } "}}if(e.schema.$ref&&!s)i+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",f&&(i+=" } if (errors === ",i+=g?"0":"errs_"+c,i+=") { ",E+="}");else{var C=e.RULES;if(C)for(var R=-1,L=C.length-1;R<L;)if(Y(S=C[R+=1])){if(S.type&&(i+=" if ("+e.util.checkDataType(S.type,m)+") { "),e.opts.useDefaults)if("object"==S.type&&e.schema.properties){h=e.schema.properties;var q=Object.keys(h);if(q)for(var M,N=-1,z=q.length-1;N<z;)if(void 0!==(B=h[M=q[N+=1]]).default){var V=m+e.util.getProperty(M);if(e.compositeRule){if(e.opts.strictDefaults){if(b="default is ignored for: "+V,"log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else i+=" if ("+V+" === undefined ","empty"==e.opts.useDefaults&&(i+=" || "+V+" === null || "+V+" === '' "),i+=" ) "+V+" = ","shared"==e.opts.useDefaults?i+=" "+e.useDefault(B.default)+" ":i+=" "+JSON.stringify(B.default)+" ",i+="; "}}else if("array"==S.type&&Array.isArray(e.schema.items)){var U=e.schema.items;if(U){F=-1;for(var B,K=U.length-1;F<K;)if(void 0!==(B=U[F+=1]).default)if(V=m+"["+F+"]",e.compositeRule){if(e.opts.strictDefaults){if(b="default is ignored for: "+V,"log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else i+=" if ("+V+" === undefined ","empty"==e.opts.useDefaults&&(i+=" || "+V+" === null || "+V+" === '' "),i+=" ) "+V+" = ","shared"==e.opts.useDefaults?i+=" "+e.useDefault(B.default)+" ":i+=" "+JSON.stringify(B.default)+" ",i+="; "}}var H,Q=S.rules;if(Q)for(var W,G=-1,J=Q.length-1;G<J;)if(X(W=Q[G+=1])){var Z=W.code(e,W.keyword,S.type);Z&&(i+=" "+Z+" ",f&&(P+="}"))}f&&(i+=" "+P+" ",P=""),S.type&&(i+=" } ",x&&x===S.type&&!_)&&(i+=" else { ",u=e.schemaPath+".type",d=e.errSchemaPath+"/type",(H=H||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { type: '",i+=w?""+x.join(","):""+x,i+="' } ",!1!==e.opts.messages&&(i+=" , message: 'should be ",i+=w?""+x.join(","):""+x,i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),i+=" } "):i+=" {} ",y=i,i=H.pop(),!e.compositeRule&&f?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } "),f&&(i+=" if (errors === ",i+=g?"0":"errs_"+c,i+=") { ",E+="}")}}function Y(e){for(var t=e.rules,r=0;r<t.length;r++)if(X(t[r]))return!0}function X(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var r=t.implements,i=0;i<r.length;i++)if(void 0!==e.schema[r[i]])return!0}(t)}return f&&(i+=" "+E+" "),g?(a?(i+=" if (errors === 0) return data;           ",i+=" else throw new ValidationError(vErrors); "):(i+=" validate.errors = vErrors; ",i+=" return errors === 0;       "),i+=" }; return validate;"):i+=" var "+v+" = errors === errs_"+c+";",i=e.util.cleanUpCode(i),g&&(i=e.util.finalCleanUpCode(i,a)),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,h="data"+(o||""),u=e.opts.$data&&n&&n.$data;u?(a+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",i="schema"+s):i=n;var d="maximum"==t,f=d?"exclusiveMaximum":"exclusiveMinimum",m=e.schema[f],v=e.opts.$data&&m&&m.$data,y=d?"<":">",g=d?">":"<",b=void 0;if(v){var P,E=e.util.getData(m.$data,o,e.dataPathArr),x="exclusive"+s,w="exclType"+s,_="exclIsNumber"+s,S="' + "+(j="op"+s)+" + '";a+=" var schemaExcl"+s+" = "+E+"; ",a+=" var "+x+"; var "+w+" = typeof "+(E="schemaExcl"+s)+"; if ("+w+" != 'boolean' && "+w+" != 'undefined' && "+w+" != 'number') { ",b=f,(P=P||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(b||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: '"+f+" should be boolean' "),e.opts.verbose&&(a+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var $=a;a=P.pop(),!e.compositeRule&&p?e.async?a+=" throw new ValidationError(["+$+"]); ":a+=" validate.errors = ["+$+"]; return false; ":a+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else if ( ",u&&(a+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),a+=" "+w+" == 'number' ? ( ("+x+" = "+i+" === undefined || "+E+" "+y+"= "+i+") ? "+h+" "+g+"= "+E+" : "+h+" "+g+" "+i+" ) : ( ("+x+" = "+E+" === true) ? "+h+" "+g+"= "+i+" : "+h+" "+g+" "+i+" ) || "+h+" !== "+h+") { var op"+s+" = "+x+" ? '"+y+"' : '"+y+"='; ",void 0===n&&(b=f,c=e.errSchemaPath+"/"+f,i=E,u=v)}else if(S=y,(_="number"==typeof m)&&u){var j="'"+S+"'";a+=" if ( ",u&&(a+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),a+=" ( "+i+" === undefined || "+m+" "+y+"= "+i+" ? "+h+" "+g+"= "+m+" : "+h+" "+g+" "+i+" ) || "+h+" !== "+h+") { "}else _&&void 0===n?(x=!0,b=f,c=e.errSchemaPath+"/"+f,i=m,g+="="):(_&&(i=Math[d?"min":"max"](m,n)),m===(!_||i)?(x=!0,b=f,c=e.errSchemaPath+"/"+f,g+="="):(x=!1,S+="=")),j="'"+S+"'",a+=" if ( ",u&&(a+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),a+=" "+h+" "+g+" "+i+" || "+h+" !== "+h+") { ";return b=b||t,(P=P||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(b||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+j+", limit: "+i+", exclusive: "+x+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be "+S+" ",a+=u?"' + "+i:i+"'"),e.opts.verbose&&(a+=" , schema:  ",a+=u?"validate.schema"+l:""+n,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ",$=a,a=P.pop(),!e.compositeRule&&p?e.async?a+=" throw new ValidationError(["+$+"]); ":a+=" validate.errors = ["+$+"]; return false; ":a+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",p&&(a+=" else { "),a}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,h="data"+(o||""),u=e.opts.$data&&n&&n.$data;u?(a+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",i="schema"+s):i=n,a+="if ( ",u&&(a+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),a+=" "+h+".length "+("maxItems"==t?">":"<")+" "+i+") { ";var d=t,f=f||[];f.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(d||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+i+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have ",a+="maxItems"==t?"more":"fewer",a+=" than ",a+=u?"' + "+i+" + '":""+n,a+=" items' "),e.opts.verbose&&(a+=" , schema:  ",a+=u?"validate.schema"+l:""+n,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var m=a;return a=f.pop(),!e.compositeRule&&p?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",p&&(a+=" else { "),a}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,h="data"+(o||""),u=e.opts.$data&&n&&n.$data;u?(a+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",i="schema"+s):i=n;var d="maxLength"==t?">":"<";a+="if ( ",u&&(a+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),!1===e.opts.unicode?a+=" "+h+".length ":a+=" ucs2length("+h+") ",a+=" "+d+" "+i+") { ";var f=t,m=m||[];m.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(f||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+i+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT be ",a+="maxLength"==t?"longer":"shorter",a+=" than ",a+=u?"' + "+i+" + '":""+n,a+=" characters' "),e.opts.verbose&&(a+=" , schema:  ",a+=u?"validate.schema"+l:""+n,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var v=a;return a=m.pop(),!e.compositeRule&&p?e.async?a+=" throw new ValidationError(["+v+"]); ":a+=" validate.errors = ["+v+"]; return false; ":a+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",p&&(a+=" else { "),a}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,h="data"+(o||""),u=e.opts.$data&&n&&n.$data;u?(a+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",i="schema"+s):i=n,a+="if ( ",u&&(a+=" ("+i+" !== undefined && typeof "+i+" != 'number') || "),a+=" Object.keys("+h+").length "+("maxProperties"==t?">":"<")+" "+i+") { ";var d=t,f=f||[];f.push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(d||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+i+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have ",a+="maxProperties"==t?"more":"fewer",a+=" than ",a+=u?"' + "+i+" + '":""+n,a+=" properties' "),e.opts.verbose&&(a+=" , schema:  ",a+=u?"validate.schema"+l:""+n,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var m=a;return a=f.pop(),!e.compositeRule&&p?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",p&&(a+=" else { "),a}},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},function(e,t,r){const i=r(13),a=r(48),s=r(50),o={"overall-narrative":r(52),actors:r(53),cutscene:r(54),dialogue:r(55),enemies:r(56),gameplay:r(57),items:r(58),"player-profile":r(59),tilesets:r(60)};t.createStoryLine=function(e,t,r){if(!e||!t)return{error:"Invalid player type / overall story data!"};let n=i(t,o["overall-narrative"]);if("valid"===n){let i=a(t);if(0!=i.errors.length)return{error:i.errors};let o=s(e,i.graph);if(0==o.scenes.length)return{error:"Story has no scenes."};let n,l=[];for(scene of o.scenes)0==scene.events.length&&l.push("Scene "+scene.name+" has no events.");return 0!=l.length?{error:l}:(n=r?{graph:i,story:o}:o,n)}return{error:n}},t.validateNarrativeFile=function(e,t){return o[e]?t?i(t,o[e]):{error:"Invalid file data"}:{error:"Invalid file type"}}},function(e,t,r){let i=r(14);e.exports=function(e,t){let r=(new i).compile(t);return r(e)?"valid":r.errors}},function(e,t,r){"use strict";var i=r(15),a=r(1),s=r(19),o=r(4),n=r(5),l=r(20),c=r(21),p=r(42),h=r(0);e.exports=y,y.prototype.validate=function(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var i=this._addSchema(e);r=i.validate||this._compile(i)}var a=r(t);return!0!==r.$async&&(this.errors=r.errors),a},y.prototype.compile=function(e,t){var r=this._addSchema(e,void 0,t);return r.validate||this._compile(r)},y.prototype.addSchema=function(e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)this.addSchema(e[s],void 0,r,i);return this}var o=this._getId(e);if(void 0!==o&&"string"!=typeof o)throw new Error("schema id must be string");return w(this,t=a.normalizeId(t||o)),this._schemas[t]=this._addSchema(e,r,i,!0),this},y.prototype.addMetaSchema=function(e,t,r){return this.addSchema(e,t,r,!0),this},y.prototype.validateSchema=function(e,t){var r=e.$schema;if(void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(f)?f:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var i=this.validate(r,e);if(!i&&t){var a="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(a);this.logger.error(a)}return i},y.prototype.getSchema=function(e){var t=g(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var r=a.schema.call(e,{schema:{}},t);if(r){var s=r.schema,n=r.root,l=r.baseId,c=i.call(e,s,n,void 0,l);return e._fragments[t]=new o({ref:t,fragment:!0,schema:s,root:n,baseId:l,validate:c}),c}}(this,e)}},y.prototype.removeSchema=function(e){if(e instanceof RegExp)return b(this,this._schemas,e),b(this,this._refs,e),this;switch(typeof e){case"undefined":return b(this,this._schemas),b(this,this._refs),this._cache.clear(),this;case"string":var t=g(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,i=r?r(e):e;this._cache.del(i);var s=this._getId(e);s&&(s=a.normalizeId(s),delete this._schemas[s],delete this._refs[s])}return this},y.prototype.addFormat=function(e,t){return"string"==typeof t&&(t=new RegExp(t)),this._formats[e]=t,this},y.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var r=void 0===(t=t||{}).separator?", ":t.separator,i=void 0===t.dataVar?"data":t.dataVar,a="",s=0;s<e.length;s++){var o=e[s];o&&(a+=i+o.dataPath+" "+o.message+r)}return a.slice(0,-r.length)},y.prototype._addSchema=function(e,t,r,i){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var s=this._opts.serialize,n=s?s(e):e,l=this._cache.get(n);if(l)return l;i=i||!1!==this._opts.addUsedSchema;var c=a.normalizeId(this._getId(e));c&&i&&w(this,c);var p,h=!1!==this._opts.validateSchema&&!t;h&&!(p=c&&c==a.normalizeId(e.$schema))&&this.validateSchema(e,!0);var u=a.ids.call(this,e),d=new o({id:c,schema:e,localRefs:u,cacheKey:n,meta:r});return"#"!=c[0]&&i&&(this._refs[c]=d),this._cache.put(n,d),h&&p&&this.validateSchema(e,!0),d},y.prototype._compile=function(e,t){if(e.compiling)return e.validate=s,s.schema=e.schema,s.errors=null,s.root=t||s,!0===e.schema.$async&&(s.$async=!0),s;var r,a;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{a=i.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=a,e.refs=a.refs,e.refVal=a.refVal,e.root=a.root,a;function s(){var t=e.validate,r=t.apply(this,arguments);return s.errors=t.errors,r}},y.prototype.compileAsync=r(43);var u=r(44);y.prototype.addKeyword=u.add,y.prototype.getKeyword=u.get,y.prototype.removeKeyword=u.remove,y.prototype.validateKeyword=u.validate;var d=r(3);y.ValidationError=d.Validation,y.MissingRefError=d.MissingRef,y.$dataMetaSchema=p;var f="http://json-schema.org/draft-07/schema",m=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],v=["/properties"];function y(e){if(!(this instanceof y))return new y(e);e=this._opts=h.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:_,warn:_,error:_};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=l(e.format),this._cache=e.cache||new s,this._loadingSchemas={},this._compilations=[],this.RULES=c(),this._getId=function(e){switch(e.schemaId){case"auto":return x;case"id":return P;default:return E}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=n),this._metaOpts=function(e){for(var t=h.copy(e._opts),r=0;r<m.length;r++)delete t[m[r]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),e.keywords&&function(e){for(var t in e._opts.keywords){var r=e._opts.keywords[t];e.addKeyword(t,r)}}(this),function(e){var t;if(e._opts.$data&&(t=r(47),e.addMetaSchema(t,t.$id,!0)),!1!==e._opts.meta){var i=r(11);e._opts.$data&&(i=p(i,v)),e.addMetaSchema(i,f,!0),e._refs["http://json-schema.org/schema"]=f}}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(t)if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function g(e,t){return t=a.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function b(e,t,r){for(var i in t){var a=t[i];a.meta||r&&!r.test(i)||(e._cache.del(a.cacheKey),delete t[i])}}function P(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function E(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function x(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function w(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function _(){}},function(e,t,r){"use strict";var i=r(1),a=r(0),s=r(3),o=r(5),n=r(6),l=a.ucs2length,c=r(2),p=s.Validation;function h(e,t,r){var i=d.call(this,e,t,r);return i>=0?{index:i,compiling:!0}:(i=this._compilations.length,this._compilations[i]={schema:e,root:t,baseId:r},{index:i,compiling:!1})}function u(e,t,r){var i=d.call(this,e,t,r);i>=0&&this._compilations.splice(i,1)}function d(e,t,r){for(var i=0;i<this._compilations.length;i++){var a=this._compilations[i];if(a.schema==e&&a.root==t&&a.baseId==r)return i}return-1}function f(e,t){return"var pattern"+e+" = new RegExp("+a.toQuotedString(t[e])+");"}function m(e){return"var default"+e+" = defaults["+e+"];"}function v(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function y(e){return"var customRule"+e+" = customRules["+e+"];"}function g(e,t){if(!e.length)return"";for(var r="",i=0;i<e.length;i++)r+=t(i,e);return r}e.exports=function e(t,r,d,b){var P=this,E=this._opts,x=[void 0],w={},_=[],S={},$=[],j={},A=[];r=r||{schema:t,refVal:x,refs:w};var T=h.call(this,t,r,b),I=this._compilations[T.index];if(T.compiling)return I.callValidate=function e(){var t=I.validate,r=t.apply(this,arguments);return e.errors=t.errors,r};var O=this._formats,F=this.RULES;try{var k=C(t,r,d,b);I.validate=k;var D=I.callValidate;return D&&(D.schema=k.schema,D.errors=null,D.refs=k.refs,D.refVal=k.refVal,D.root=k.root,D.$async=k.$async,E.sourceCode&&(D.source=k.source)),k}finally{u.call(this,t,r,b)}function C(t,o,h,u){var d=!o||o&&o.schema==t;if(o.schema!=r.schema)return e.call(P,t,o,h,u);var b,S=!0===t.$async,j=n({isTop:!0,schema:t,isRoot:d,baseId:u,root:o,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:s.MissingRef,RULES:F,validate:n,util:a,resolve:i,resolveRef:R,usePattern:M,useDefault:N,useCustomRule:z,opts:E,formats:O,logger:P.logger,self:P});j=g(x,v)+g(_,f)+g($,m)+g(A,y)+j,E.processCode&&(j=E.processCode(j));try{b=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",j)(P,F,O,r,x,$,A,c,l,p),x[0]=b}catch(e){throw P.logger.error("Error compiling schema, function code:",j),e}return b.schema=t,b.errors=null,b.refs=w,b.refVal=x,b.root=d?b:o,S&&(b.$async=!0),!0===E.sourceCode&&(b.source={code:j,patterns:_,defaults:$}),b}function R(t,a,s){a=i.url(t,a);var o,n,l=w[a];if(void 0!==l)return q(o=x[l],n="refVal["+l+"]");if(!s&&r.refs){var c=r.refs[a];if(void 0!==c)return q(o=r.refVal[c],n=L(a,o))}n=L(a);var p=i.call(P,C,r,a);if(void 0===p){var h=d&&d[a];h&&(p=i.inlineRef(h,E.inlineRefs)?h:e.call(P,h,r,d,t))}if(void 0!==p)return function(e,t){var r=w[e];x[r]=t}(a,p),q(p,n);!function(e){delete w[e]}(a)}function L(e,t){var r=x.length;return x[r]=t,w[e]=r,"refVal"+r}function q(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function M(e){var t=S[e];return void 0===t&&(t=S[e]=_.length,_[t]=e),"pattern"+t}function N(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return a.toQuotedString(e);case"object":if(null===e)return"null";var t=o(e),r=j[t];return void 0===r&&(r=j[t]=$.length,$[r]=e),"default"+r}}function z(e,t,r,i){if(!1!==P._opts.validateSchema){var a=e.definition.dependencies;if(a&&!a.every((function(e){return Object.prototype.hasOwnProperty.call(r,e)})))throw new Error("parent schema must have all required keywords: "+a.join(","));var s=e.definition.validateSchema;if(s&&!s(t)){var o="keyword schema is invalid: "+P.errorsText(s.errors);if("log"!=P._opts.validateSchema)throw new Error(o);P.logger.error(o)}}var n,l=e.definition.compile,c=e.definition.inline,p=e.definition.macro;if(l)n=l.call(P,t,r,i);else if(p)n=p.call(P,t,r,i),!1!==E.validateSchema&&P.validateSchema(n,!0);else if(c)n=c.call(P,i,e.keyword,t,r);else if(!(n=e.definition.validate))return;if(void 0===n)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var h=A.length;return A[h]=n,{code:"customRule"+h,validate:n}}}},function(e,t,r){
/** @license URI.js v4.2.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var i=t.length-1,a=1;a<i;++a)t[a]=t[a].slice(1,-1);return t[i]=t[i].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function i(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function a(e){return e.toUpperCase()}function s(e){var i=t("[0-9]","[A-Fa-f]"),a=r(r("%[EFef]"+i+"%"+i+i+"%"+i+i)+"|"+r("%[89A-Fa-f]"+i+"%"+i+i)+"|"+r("%"+i+i)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",o=t("[\\:\\/\\?\\#\\[\\]\\@]",s),n=e?"[\\uE000-\\uF8FF]":"[]",l=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),c=r("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),p=r(r(a+"|"+t(l,s,"[\\:]"))+"*"),h=(r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("[1-9][0-9]")+"|[0-9]"),r(r("25[0-5]")+"|"+r("2[0-4][0-9]")+"|"+r("1[0-9][0-9]")+"|"+r("0?[1-9][0-9]")+"|0?0?[0-9]")),u=r(h+"\\."+h+"\\."+h+"\\."+h),d=r(i+"{1,4}"),f=r(r(d+"\\:"+d)+"|"+u),m=r(r(d+"\\:")+"{6}"+f),v=r("\\:\\:"+r(d+"\\:")+"{5}"+f),y=r(r(d)+"?\\:\\:"+r(d+"\\:")+"{4}"+f),g=r(r(r(d+"\\:")+"{0,1}"+d)+"?\\:\\:"+r(d+"\\:")+"{3}"+f),b=r(r(r(d+"\\:")+"{0,2}"+d)+"?\\:\\:"+r(d+"\\:")+"{2}"+f),P=r(r(r(d+"\\:")+"{0,3}"+d)+"?\\:\\:"+d+"\\:"+f),E=r(r(r(d+"\\:")+"{0,4}"+d)+"?\\:\\:"+f),x=r(r(r(d+"\\:")+"{0,5}"+d)+"?\\:\\:"+d),w=r(r(r(d+"\\:")+"{0,6}"+d)+"?\\:\\:"),_=r([m,v,y,g,b,P,E,x,w].join("|")),S=r(r(l+"|"+a)+"+"),$=(r(_+"\\%25"+S),r(_+r("\\%25|\\%(?!"+i+"{2})")+S)),j=r("[vV]"+i+"+\\."+t(l,s,"[\\:]")+"+"),A=r("\\["+r($+"|"+_+"|"+j)+"\\]"),T=r(r(a+"|"+t(l,s))+"*"),I=r(A+"|"+u+"(?!"+T+")|"+T),O=r("[0-9]*"),F=r(r(p+"@")+"?"+I+r("\\:"+O)+"?"),k=r(a+"|"+t(l,s,"[\\:\\@]")),D=r(k+"*"),C=r(k+"+"),R=r(r(a+"|"+t(l,s,"[\\@]"))+"+"),L=r(r("\\/"+D)+"*"),q=r("\\/"+r(C+L)+"?"),M=r(R+L),N=r(C+L),z="(?!"+k+")",V=(r(L+"|"+q+"|"+M+"|"+N+"|"+z),r(r(k+"|"+t("[\\/\\?]",n))+"*")),U=r(r(k+"|[\\/\\?]")+"*"),B=r(r("\\/\\/"+F+L)+"|"+q+"|"+N+"|"+z),K=r(c+"\\:"+B+r("\\?"+V)+"?"+r("\\#"+U)+"?"),H=r(r("\\/\\/"+F+L)+"|"+q+"|"+M+"|"+z),Q=r(H+r("\\?"+V)+"?"+r("\\#"+U)+"?");return r(K+"|"+Q),r(c+"\\:"+B+r("\\?"+V)+"?"),r(r("\\/\\/("+r("("+p+")@")+"?("+I+")"+r("\\:("+O+")")+"?)")+"?("+L+"|"+q+"|"+N+"|"+z+")"),r("\\?("+V+")"),r("\\#("+U+")"),r(r("\\/\\/("+r("("+p+")@")+"?("+I+")"+r("\\:("+O+")")+"?)")+"?("+L+"|"+q+"|"+M+"|"+z+")"),r("\\?("+V+")"),r("\\#("+U+")"),r(r("\\/\\/("+r("("+p+")@")+"?("+I+")"+r("\\:("+O+")")+"?)")+"?("+L+"|"+q+"|"+N+"|"+z+")"),r("\\?("+V+")"),r("\\#("+U+")"),r("("+p+")@"),r("\\:("+O+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",l,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",l,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",l,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",l,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",l,s,"[\\:\\@\\/\\?]",n),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",l,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",l,s),"g"),UNRESERVED:new RegExp(l,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",l,o),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+u+")$"),IPV6ADDRESS:new RegExp("^\\[?("+_+")"+r(r("\\%25|\\%(?!"+i+"{2})")+"("+S+")")+"?\\]?$")}}var o=s(!1),n=s(!0),l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,a=!1,s=void 0;try{for(var o,n=e[Symbol.iterator]();!(i=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(e){a=!0,s=e}finally{try{!i&&n.return&&n.return()}finally{if(a)throw s}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},c=2147483647,p=/^xn--/,h=/[^\0-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,m=String.fromCharCode;function v(e){throw new RangeError(d[e])}function y(e,t){var r=e.split("@"),i="";r.length>1&&(i=r[0]+"@",e=r[1]);var a=function(e,t){for(var r=[],i=e.length;i--;)r[i]=t(e[i]);return r}((e=e.replace(u,".")).split("."),t).join(".");return i+a}var g=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},b=function(e,t,r){var i=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;i+=36)e=f(e/35);return f(i+36*e/(e+38))},P=function(e){return y(e,(function(e){return h.test(e)?"xn--"+function(e){var t=[],r=(e=function(e){for(var t=[],r=0,i=e.length;r<i;){var a=e.charCodeAt(r++);if(a>=55296&&a<=56319&&r<i){var s=e.charCodeAt(r++);56320==(64512&s)?t.push(((1023&a)<<10)+(1023&s)+65536):(t.push(a),r--)}else t.push(a)}return t}(e)).length,i=128,a=0,s=72,o=!0,n=!1,l=void 0;try{for(var p,h=e[Symbol.iterator]();!(o=(p=h.next()).done);o=!0){var u=p.value;u<128&&t.push(m(u))}}catch(e){n=!0,l=e}finally{try{!o&&h.return&&h.return()}finally{if(n)throw l}}var d=t.length,y=d;for(d&&t.push("-");y<r;){var P=c,E=!0,x=!1,w=void 0;try{for(var _,S=e[Symbol.iterator]();!(E=(_=S.next()).done);E=!0){var $=_.value;$>=i&&$<P&&(P=$)}}catch(e){x=!0,w=e}finally{try{!E&&S.return&&S.return()}finally{if(x)throw w}}var j=y+1;P-i>f((c-a)/j)&&v("overflow"),a+=(P-i)*j,i=P;var A=!0,T=!1,I=void 0;try{for(var O,F=e[Symbol.iterator]();!(A=(O=F.next()).done);A=!0){var k=O.value;if(k<i&&++a>c&&v("overflow"),k==i){for(var D=a,C=36;;C+=36){var R=C<=s?1:C>=s+26?26:C-s;if(D<R)break;var L=D-R,q=36-R;t.push(m(g(R+L%q,0))),D=f(L/q)}t.push(m(g(D,0))),s=b(a,j,y==d),a=0,++y}}}catch(e){T=!0,I=e}finally{try{!A&&F.return&&F.return()}finally{if(T)throw I}}++a,++i}return t.join("")}(e):e}))},E=function(e){return y(e,(function(e){return p.test(e)?function(e){var t,r=[],i=e.length,a=0,s=128,o=72,n=e.lastIndexOf("-");n<0&&(n=0);for(var l=0;l<n;++l)e.charCodeAt(l)>=128&&v("not-basic"),r.push(e.charCodeAt(l));for(var p=n>0?n+1:0;p<i;){for(var h=a,u=1,d=36;;d+=36){p>=i&&v("invalid-input");var m=(t=e.charCodeAt(p++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(m>=36||m>f((c-a)/u))&&v("overflow"),a+=m*u;var y=d<=o?1:d>=o+26?26:d-o;if(m<y)break;var g=36-y;u>f(c/g)&&v("overflow"),u*=g}var P=r.length+1;o=b(a-h,P,0==h),f(a/P)>c-s&&v("overflow"),s+=f(a/P),a%=P,r.splice(a++,0,s)}return String.fromCodePoint.apply(String,r)}(e.slice(4).toLowerCase()):e}))},x={};function w(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function _(e){for(var t="",r=0,i=e.length;r<i;){var a=parseInt(e.substr(r+1,2),16);if(a<128)t+=String.fromCharCode(a),r+=3;else if(a>=194&&a<224){if(i-r>=6){var s=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&a)<<6|63&s)}else t+=e.substr(r,6);r+=6}else if(a>=224){if(i-r>=9){var o=parseInt(e.substr(r+4,2),16),n=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&a)<<12|(63&o)<<6|63&n)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function S(e,t){function r(e){var r=_(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,w).replace(t.PCT_ENCODED,a)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,w).replace(t.PCT_ENCODED,a)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,w).replace(t.PCT_ENCODED,a)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,w).replace(t.PCT_ENCODED,a)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,w).replace(t.PCT_ENCODED,a)),e}function $(e){return e.replace(/^0*(.*)/,"$1")||"0"}function j(e,t){var r=e.match(t.IPV4ADDRESS)||[],i=l(r,2)[1];return i?i.split(".").map($).join("."):e}function A(e,t){var r=e.match(t.IPV6ADDRESS)||[],i=l(r,3),a=i[1],s=i[2];if(a){for(var o=a.toLowerCase().split("::").reverse(),n=l(o,2),c=n[0],p=n[1],h=p?p.split(":").map($):[],u=c.split(":").map($),d=t.IPV4ADDRESS.test(u[u.length-1]),f=d?7:8,m=u.length-f,v=Array(f),y=0;y<f;++y)v[y]=h[y]||u[m+y]||"";d&&(v[f-1]=j(v[f-1],t));var g=v.reduce((function(e,t,r){if(!t||"0"===t){var i=e[e.length-1];i&&i.index+i.length===r?i.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(g&&g.length>1){var P=v.slice(0,g.index),E=v.slice(g.index+g.length);b=P.join(":")+"::"+E.join(":")}else b=v.join(":");return s&&(b+="%"+s),b}return e}var T=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,I=void 0==="".match(/(){0}/)[1];function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},i=!1!==t.iri?n:o;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var a=e.match(T);if(a){I?(r.scheme=a[1],r.userinfo=a[3],r.host=a[4],r.port=parseInt(a[5],10),r.path=a[6]||"",r.query=a[7],r.fragment=a[8],isNaN(r.port)&&(r.port=a[5])):(r.scheme=a[1]||void 0,r.userinfo=-1!==e.indexOf("@")?a[3]:void 0,r.host=-1!==e.indexOf("//")?a[4]:void 0,r.port=parseInt(a[5],10),r.path=a[6]||"",r.query=-1!==e.indexOf("?")?a[7]:void 0,r.fragment=-1!==e.indexOf("#")?a[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?a[4]:void 0)),r.host&&(r.host=A(j(r.host,i),i)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var s=x[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||s&&s.unicodeSupport)S(r,i);else{if(r.host&&(t.domainHost||s&&s.domainHost))try{r.host=P(r.host.replace(i.PCT_ENCODED,_).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}S(r,o)}s&&s.parse&&s.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function F(e,t){var r=!1!==t.iri?n:o,i=[];return void 0!==e.userinfo&&(i.push(e.userinfo),i.push("@")),void 0!==e.host&&i.push(A(j(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"==typeof e.port&&(i.push(":"),i.push(e.port.toString(10))),i.length?i.join(""):void 0}var k=/^\.\.?\//,D=/^\/\.(\/|$)/,C=/^\/\.\.(\/|$)/,R=/^\/?(?:.|\n)*?(?=\/|$)/;function L(e){for(var t=[];e.length;)if(e.match(k))e=e.replace(k,"");else if(e.match(D))e=e.replace(D,"/");else if(e.match(C))e=e.replace(C,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(R);if(!r)throw new Error("Unexpected dot segment condition");var i=r[0];e=e.slice(i.length),t.push(i)}return t.join("")}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?n:o,i=[],a=x[(t.scheme||e.scheme||"").toLowerCase()];if(a&&a.serialize&&a.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||a&&a.domainHost)try{e.host=t.iri?E(e.host):P(e.host.replace(r.PCT_ENCODED,_).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}S(e,r),"suffix"!==t.reference&&e.scheme&&(i.push(e.scheme),i.push(":"));var s=F(e,t);if(void 0!==s&&("suffix"!==t.reference&&i.push("//"),i.push(s),e.path&&"/"!==e.path.charAt(0)&&i.push("/")),void 0!==e.path){var l=e.path;t.absolutePath||a&&a.absolutePath||(l=L(l)),void 0===s&&(l=l.replace(/^\/\//,"/%2F")),i.push(l)}return void 0!==e.query&&(i.push("?"),i.push(e.query)),void 0!==e.fragment&&(i.push("#"),i.push(e.fragment)),i.join("")}function M(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3],a={};return i||(e=O(q(e,r),r),t=O(q(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(a.scheme=t.scheme,a.userinfo=t.userinfo,a.host=t.host,a.port=t.port,a.path=L(t.path||""),a.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(a.userinfo=t.userinfo,a.host=t.host,a.port=t.port,a.path=L(t.path||""),a.query=t.query):(t.path?("/"===t.path.charAt(0)?a.path=L(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?a.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:a.path=t.path:a.path="/"+t.path,a.path=L(a.path)),a.query=t.query):(a.path=e.path,void 0!==t.query?a.query=t.query:a.query=e.query),a.userinfo=e.userinfo,a.host=e.host,a.port=e.port),a.scheme=e.scheme),a.fragment=t.fragment,a}function N(e,t){return e&&e.toString().replace(t&&t.iri?n.PCT_ENCODED:o.PCT_ENCODED,_)}var z={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return e.port!==("https"!==String(e.scheme).toLowerCase()?80:443)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},V={scheme:"https",domainHost:z.domainHost,parse:z.parse,serialize:z.serialize},U={},B="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",K="[0-9A-Fa-f]",H=r(r("%[EFef]"+K+"%"+K+K+"%"+K+K)+"|"+r("%[89A-Fa-f]"+K+"%"+K+K)+"|"+r("%"+K+K)),Q=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),W=new RegExp(B,"g"),G=new RegExp(H,"g"),J=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Q),"g"),Z=new RegExp(t("[^]",B,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),Y=Z;function X(e){var t=_(e);return t.match(W)?t:e}var ee={scheme:"mailto",parse:function(e,t){var r=e,i=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var a=!1,s={},o=r.query.split("&"),n=0,l=o.length;n<l;++n){var c=o[n].split("=");switch(c[0]){case"to":for(var p=c[1].split(","),h=0,u=p.length;h<u;++h)i.push(p[h]);break;case"subject":r.subject=N(c[1],t);break;case"body":r.body=N(c[1],t);break;default:a=!0,s[N(c[0],t)]=N(c[1],t)}}a&&(r.headers=s)}r.query=void 0;for(var d=0,f=i.length;d<f;++d){var m=i[d].split("@");if(m[0]=N(m[0]),t.unicodeSupport)m[1]=N(m[1],t).toLowerCase();else try{m[1]=P(N(m[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}i[d]=m.join("@")}return r},serialize:function(e,t){var r,i=e,s=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(s){for(var o=0,n=s.length;o<n;++o){var l=String(s[o]),c=l.lastIndexOf("@"),p=l.slice(0,c).replace(G,X).replace(G,a).replace(J,w),h=l.slice(c+1);try{h=t.iri?E(h):P(N(h,t).toLowerCase())}catch(e){i.error=i.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}s[o]=p+"@"+h}i.path=s.join(",")}var u=e.headers=e.headers||{};e.subject&&(u.subject=e.subject),e.body&&(u.body=e.body);var d=[];for(var f in u)u[f]!==U[f]&&d.push(f.replace(G,X).replace(G,a).replace(Z,w)+"="+u[f].replace(G,X).replace(G,a).replace(Y,w));return d.length&&(i.query=d.join("&")),i}},te=/^([^\:]+)\:(.*)/,re={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(te),i=e;if(r){var a=t.scheme||i.scheme||"urn",s=r[1].toLowerCase(),o=r[2],n=a+":"+(t.nid||s),l=x[n];i.nid=s,i.nss=o,i.path=void 0,l&&(i=l.parse(i,t))}else i.error=i.error||"URN can not be parsed.";return i},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",i=e.nid,a=r+":"+(t.nid||i),s=x[a];s&&(e=s.serialize(e,t));var o=e,n=e.nss;return o.path=(i||t.nid)+":"+n,o}},ie=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ae={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ie)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};x[z.scheme]=z,x[V.scheme]=V,x[ee.scheme]=ee,x[re.scheme]=re,x[ae.scheme]=ae,e.SCHEMES=x,e.pctEncChar=w,e.pctDecChars=_,e.parse=O,e.removeDotSegments=L,e.serialize=q,e.resolveComponents=M,e.resolve=function(e,t,r){var i=function(e,t){var r={scheme:"null"};if(t)for(var i in t)r[i]=t[i];return r}(0,r);return q(M(O(e,i),O(t,i),i,!0),i)},e.normalize=function(e,t){return"string"==typeof e?e=q(O(e,t),t):"object"===i(e)&&(e=O(q(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=q(O(e,r),r):"object"===i(e)&&(e=q(e,r)),"string"==typeof t?t=q(O(t,r),r):"object"===i(t)&&(t=q(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?n.ESCAPE:o.ESCAPE,w)},e.unescapeComponent=N,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,r){"use strict";e.exports=function(e){for(var t,r=0,i=e.length,a=0;a<i;)r++,(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<i&&56320==(64512&(t=e.charCodeAt(a)))&&a++;return r}},function(e,t,r){"use strict";var i=e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),function e(t,r,a,s,o,n,l,c,p,h){if(s&&"object"==typeof s&&!Array.isArray(s)){for(var u in r(s,o,n,l,c,p,h),s){var d=s[u];if(Array.isArray(d)){if(u in i.arrayKeywords)for(var f=0;f<d.length;f++)e(t,r,a,d[f],o+"/"+u+"/"+f,n,o,u,s,f)}else if(u in i.propsKeywords){if(d&&"object"==typeof d)for(var m in d)e(t,r,a,d[m],o+"/"+u+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),n,o,u,s,m)}else(u in i.keywords||t.allKeys&&!(u in i.skipKeywords))&&e(t,r,a,d,o+"/"+u,n,o,u,s)}a(s,o,n,l,c,p,h)}}(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};i.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},i.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},i.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},i.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,r){"use strict";var i=e.exports=function(){this._cache={}};i.prototype.put=function(e,t){this._cache[e]=t},i.prototype.get=function(e){return this._cache[e]},i.prototype.del=function(e){delete this._cache[e]},i.prototype.clear=function(){this._cache={}}},function(e,t,r){"use strict";var i=r(0),a=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,s=[0,31,28,31,30,31,30,31,31,30,31,30,31],o=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,n=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,c=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,p=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,h=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,u=/^(?:\/(?:[^~/]|~0|~1)*)*$/,d=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,f=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function m(e){return e="full"==e?"full":"fast",i.copy(m[e])}function v(e){var t=e.match(a);if(!t)return!1;var r=+t[1],i=+t[2],o=+t[3];return i>=1&&i<=12&&o>=1&&o<=(2==i&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:s[i])}function y(e,t){var r=e.match(o);if(!r)return!1;var i=r[1],a=r[2],s=r[3],n=r[5];return(i<=23&&a<=59&&s<=59||23==i&&59==a&&60==s)&&(!t||n)}e.exports=m,m.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":c,url:p,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:n,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:E,uuid:h,"json-pointer":u,"json-pointer-uri-fragment":d,"relative-json-pointer":f},m.full={date:v,time:y,"date-time":function(e){var t=e.split(g);return 2==t.length&&v(t[0])&&y(t[1],!0)},uri:function(e){return b.test(e)&&l.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":c,url:p,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:n,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:E,uuid:h,"json-pointer":u,"json-pointer-uri-fragment":d,"relative-json-pointer":f};var g=/t|\s/i,b=/\/|:/,P=/[^\\]\\Z/;function E(e){if(P.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},function(e,t,r){"use strict";var i=r(22),a=r(0).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=a(t),e.types=a(["number","integer","string","array","object","boolean","null"]),e.forEach((function(r){r.rules=r.rules.map((function(r){var a;if("object"==typeof r){var s=Object.keys(r)[0];a=r[s],r=s,a.forEach((function(r){t.push(r),e.all[r]=!0}))}return t.push(r),e.all[r]={keyword:r,code:i[r],implements:a}})),e.all.$comment={keyword:"$comment",code:i.$comment},r.type&&(e.types[r.type]=r)})),e.keywords=a(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},function(e,t,r){"use strict";e.exports={$ref:r(23),allOf:r(24),anyOf:r(25),$comment:r(26),const:r(27),contains:r(28),dependencies:r(29),enum:r(30),format:r(31),if:r(32),items:r(33),maximum:r(7),minimum:r(7),maxItems:r(8),minItems:r(8),maxLength:r(9),minLength:r(9),maxProperties:r(10),minProperties:r(10),multipleOf:r(34),not:r(35),oneOf:r(36),pattern:r(37),properties:r(38),propertyNames:r(39),required:r(40),uniqueItems:r(41),validate:r(6)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a,s=" ",o=e.level,n=e.dataLevel,l=e.schema[t],c=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,h="data"+(n||""),u="valid"+o;if("#"==l||"#/"==l)e.isRoot?(i=e.async,a="validate"):(i=!0===e.root.schema.$async,a="root.refVal[0]");else{var d=e.resolveRef(e.baseId,l,e.isRoot);if(void 0===d){var f=e.MissingRefError.message(e.baseId,l);if("fail"==e.opts.missingRefs){e.logger.error(f),(g=g||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",!1!==e.opts.messages&&(s+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(s+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var m=s;s=g.pop(),!e.compositeRule&&p?e.async?s+=" throw new ValidationError(["+m+"]); ":s+=" validate.errors = ["+m+"]; return false; ":s+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",p&&(s+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,l,f);e.logger.warn(f),p&&(s+=" if (true) { ")}}else if(d.inline){var v=e.util.copy(e);v.level++;var y="valid"+v.level;v.schema=d.schema,v.schemaPath="",v.errSchemaPath=l,s+=" "+e.validate(v).replace(/validate\.schema/g,d.code)+" ",p&&(s+=" if ("+y+") { ")}else i=!0===d.$async||e.async&&!1!==d.$async,a=d.code}if(a){var g;(g=g||[]).push(s),s="",e.opts.passContext?s+=" "+a+".call(this, ":s+=" "+a+"( ",s+=" "+h+", (dataPath || '')",'""'!=e.errorPath&&(s+=" + "+e.errorPath);var b=s+=" , "+(n?"data"+(n-1||""):"parentData")+" , "+(n?e.dataPathArr[n]:"parentDataProperty")+", rootData)  ";if(s=g.pop(),i){if(!e.async)throw new Error("async schema referenced by sync schema");p&&(s+=" var "+u+"; "),s+=" try { await "+b+"; ",p&&(s+=" "+u+" = true; "),s+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",p&&(s+=" "+u+" = false; "),s+=" } ",p&&(s+=" if ("+u+") { ")}else s+=" if (!"+b+") { if (vErrors === null) vErrors = "+a+".errors; else vErrors = vErrors.concat("+a+".errors); errors = vErrors.length; } ",p&&(s+=" else { ")}return s}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,n=!e.opts.allErrors,l=e.util.copy(e),c="";l.level++;var p="valid"+l.level,h=l.baseId,u=!0,d=a;if(d)for(var f,m=-1,v=d.length-1;m<v;)f=d[m+=1],(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0:e.util.schemaHasRules(f,e.RULES.all))&&(u=!1,l.schema=f,l.schemaPath=s+"["+m+"]",l.errSchemaPath=o+"/"+m,i+="  "+e.validate(l)+" ",l.baseId=h,n&&(i+=" if ("+p+") { ",c+="}"));return n&&(i+=u?" if (true) { ":" "+c.slice(0,-1)+" "),e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="valid"+a,u="errs__"+a,d=e.util.copy(e),f="";d.level++;var m="valid"+d.level;if(o.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0:e.util.schemaHasRules(t,e.RULES.all)}))){var v=d.baseId;i+=" var "+u+" = errors; var "+h+" = false;  ";var y=e.compositeRule;e.compositeRule=d.compositeRule=!0;var g=o;if(g)for(var b,P=-1,E=g.length-1;P<E;)b=g[P+=1],d.schema=b,d.schemaPath=n+"["+P+"]",d.errSchemaPath=l+"/"+P,i+="  "+e.validate(d)+" ",d.baseId=v,i+=" "+h+" = "+h+" || "+m+"; if (!"+h+") { ",f+="}";e.compositeRule=d.compositeRule=y,i+=" "+f+" if (!"+h+") {   var err =   ",!1!==e.createErrors?(i+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",e.opts.allErrors&&(i+=" } "),i=e.util.cleanUpCode(i)}else c&&(i+=" if (true) { ");return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.schema[t],s=e.errSchemaPath+"/"+t,o=(e.opts.allErrors,e.util.toQuotedString(a));return!0===e.opts.$comment?i+=" console.log("+o+");":"function"==typeof e.opts.$comment&&(i+=" self._opts.$comment("+o+", "+e.util.toQuotedString(s)+", validate.root.schema);"),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="valid"+a,u=e.opts.$data&&o&&o.$data;u&&(i+=" var schema"+a+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; "),u||(i+=" var schema"+a+" = validate.schema"+n+";"),i+="var "+h+" = equal("+p+", schema"+a+"); if (!"+h+") {   ";var d=d||[];d.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValue: schema"+a+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be equal to constant' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var f=i;return i=d.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+f+"]); ":i+=" validate.errors = ["+f+"]; return false; ":i+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" }",c&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="valid"+a,u="errs__"+a,d=e.util.copy(e);d.level++;var f="valid"+d.level,m="i"+a,v=d.dataLevel=e.dataLevel+1,y="data"+v,g=e.baseId,b=e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all);if(i+="var "+u+" = errors;var "+h+";",b){var P=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=o,d.schemaPath=n,d.errSchemaPath=l,i+=" var "+f+" = false; for (var "+m+" = 0; "+m+" < "+p+".length; "+m+"++) { ",d.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers,!0);var E=p+"["+m+"]";d.dataPathArr[v]=m;var x=e.validate(d);d.baseId=g,e.util.varOccurences(x,y)<2?i+=" "+e.util.varReplace(x,y,E)+" ":i+=" var "+y+" = "+E+"; "+x+" ",i+=" if ("+f+") break; }  ",e.compositeRule=d.compositeRule=P,i+="  if (!"+f+") {"}else i+=" if ("+p+".length == 0) {";var w=w||[];w.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'should contain a valid item' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var _=i;return i=w.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+_+"]); ":i+=" validate.errors = ["+_+"]; return false; ":i+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { ",b&&(i+="  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } "),e.opts.allErrors&&(i+=" } "),e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="errs__"+a,u=e.util.copy(e),d="";u.level++;var f="valid"+u.level,m={},v={},y=e.opts.ownProperties;for(E in o){var g=o[E],b=Array.isArray(g)?v:m;b[E]=g}i+="var "+h+" = errors;";var P=e.errorPath;for(var E in i+="var missing"+a+";",v)if((b=v[E]).length){if(i+=" if ( "+p+e.util.getProperty(E)+" !== undefined ",y&&(i+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(E)+"') "),c){i+=" && ( ";var x=b;if(x)for(var w=-1,_=x.length-1;w<_;)I=x[w+=1],w&&(i+=" || "),i+=" ( ( "+(D=p+(k=e.util.getProperty(I)))+" === undefined ",y&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(I)+"') "),i+=") && (missing"+a+" = "+e.util.toQuotedString(e.opts.jsonPointers?I:k)+") ) ";i+=")) {  ";var S="missing"+a,$="' + "+S+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(P,S,!0):P+" + "+S);var j=j||[];j.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(E)+"', missingProperty: '"+$+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(i+=" , message: 'should have ",1==b.length?i+="property "+e.util.escapeQuotes(b[0]):i+="properties "+e.util.escapeQuotes(b.join(", ")),i+=" when property "+e.util.escapeQuotes(E)+" is present' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var A=i;i=j.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+A+"]); ":i+=" validate.errors = ["+A+"]; return false; ":i+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{i+=" ) { ";var T=b;if(T)for(var I,O=-1,F=T.length-1;O<F;){I=T[O+=1];var k=e.util.getProperty(I),D=($=e.util.escapeQuotes(I),p+k);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(P,I,e.opts.jsonPointers)),i+=" if ( "+D+" === undefined ",y&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(I)+"') "),i+=") {  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(E)+"', missingProperty: '"+$+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(i+=" , message: 'should have ",1==b.length?i+="property "+e.util.escapeQuotes(b[0]):i+="properties "+e.util.escapeQuotes(b.join(", ")),i+=" when property "+e.util.escapeQuotes(E)+" is present' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}i+=" }   ",c&&(d+="}",i+=" else { ")}e.errorPath=P;var C=u.baseId;for(var E in m)g=m[E],(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0:e.util.schemaHasRules(g,e.RULES.all))&&(i+=" "+f+" = true; if ( "+p+e.util.getProperty(E)+" !== undefined ",y&&(i+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(E)+"') "),i+=") { ",u.schema=g,u.schemaPath=n+e.util.getProperty(E),u.errSchemaPath=l+"/"+e.util.escapeFragment(E),i+="  "+e.validate(u)+" ",u.baseId=C,i+=" }  ",c&&(i+=" if ("+f+") { ",d+="}"));return c&&(i+="   "+d+" if ("+h+" == errors) {"),e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="valid"+a,u=e.opts.$data&&o&&o.$data;u&&(i+=" var schema"+a+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ");var d="i"+a,f="schema"+a;u||(i+=" var "+f+" = validate.schema"+n+";"),i+="var "+h+";",u&&(i+=" if (schema"+a+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+a+")) "+h+" = false; else {"),i+=h+" = false;for (var "+d+"=0; "+d+"<"+f+".length; "+d+"++) if (equal("+p+", "+f+"["+d+"])) { "+h+" = true; break; }",u&&(i+="  }  "),i+=" if (!"+h+") {   ";var m=m||[];m.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValues: schema"+a+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var v=i;return i=m.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+v+"]); ":i+=" validate.errors = ["+v+"]; return false; ":i+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" }",c&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||"");if(!1===e.opts.format)return c&&(i+=" if (true) { "),i;var h,u=e.opts.$data&&o&&o.$data;u?(i+=" var schema"+a+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ",h="schema"+a):h=o;var d=e.opts.unknownFormats,f=Array.isArray(d);if(u)i+=" var "+(m="format"+a)+" = formats["+h+"]; var "+(v="isObject"+a)+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+(y="formatType"+a)+" = "+v+" && "+m+".type || 'string'; if ("+v+") { ",e.async&&(i+=" var async"+a+" = "+m+".async; "),i+=" "+m+" = "+m+".validate; } if (  ",u&&(i+=" ("+h+" !== undefined && typeof "+h+" != 'string') || "),i+=" (","ignore"!=d&&(i+=" ("+h+" && !"+m+" ",f&&(i+=" && self._opts.unknownFormats.indexOf("+h+") == -1 "),i+=") || "),i+=" ("+m+" && "+y+" == '"+r+"' && !(typeof "+m+" == 'function' ? ",e.async?i+=" (async"+a+" ? await "+m+"("+p+") : "+m+"("+p+")) ":i+=" "+m+"("+p+") ",i+=" : "+m+".test("+p+"))))) {";else{var m;if(!(m=e.formats[o])){if("ignore"==d)return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),c&&(i+=" if (true) { "),i;if(f&&d.indexOf(o)>=0)return c&&(i+=" if (true) { "),i;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var v,y=(v="object"==typeof m&&!(m instanceof RegExp)&&m.validate)&&m.type||"string";if(v){var g=!0===m.async;m=m.validate}if(y!=r)return c&&(i+=" if (true) { "),i;if(g){if(!e.async)throw new Error("async format in sync schema");i+=" if (!(await "+(b="formats"+e.util.getProperty(o)+".validate")+"("+p+"))) { "}else{i+=" if (! ";var b="formats"+e.util.getProperty(o);v&&(b+=".validate"),i+="function"==typeof m?" "+b+"("+p+") ":" "+b+".test("+p+") ",i+=") { "}}var P=P||[];P.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { format:  ",i+=u?""+h:""+e.util.toQuotedString(o),i+="  } ",!1!==e.opts.messages&&(i+=" , message: 'should match format \"",i+=u?"' + "+h+" + '":""+e.util.escapeQuotes(o),i+="\"' "),e.opts.verbose&&(i+=" , schema:  ",i+=u?"validate.schema"+n:""+e.util.toQuotedString(o),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var E=i;return i=P.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+E+"]); ":i+=" validate.errors = ["+E+"]; return false; ":i+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",c&&(i+=" else { "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="valid"+a,u="errs__"+a,d=e.util.copy(e);d.level++;var f="valid"+d.level,m=e.schema.then,v=e.schema.else,y=void 0!==m&&(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0:e.util.schemaHasRules(m,e.RULES.all)),g=void 0!==v&&(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0:e.util.schemaHasRules(v,e.RULES.all)),b=d.baseId;if(y||g){var P;d.createErrors=!1,d.schema=o,d.schemaPath=n,d.errSchemaPath=l,i+=" var "+u+" = errors; var "+h+" = true;  ";var E=e.compositeRule;e.compositeRule=d.compositeRule=!0,i+="  "+e.validate(d)+" ",d.baseId=b,d.createErrors=!0,i+="  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; }  ",e.compositeRule=d.compositeRule=E,y?(i+=" if ("+f+") {  ",d.schema=e.schema.then,d.schemaPath=e.schemaPath+".then",d.errSchemaPath=e.errSchemaPath+"/then",i+="  "+e.validate(d)+" ",d.baseId=b,i+=" "+h+" = "+f+"; ",y&&g?i+=" var "+(P="ifClause"+a)+" = 'then'; ":P="'then'",i+=" } ",g&&(i+=" else { ")):i+=" if (!"+f+") { ",g&&(d.schema=e.schema.else,d.schemaPath=e.schemaPath+".else",d.errSchemaPath=e.errSchemaPath+"/else",i+="  "+e.validate(d)+" ",d.baseId=b,i+=" "+h+" = "+f+"; ",y&&g?i+=" var "+(P="ifClause"+a)+" = 'else'; ":P="'else'",i+=" } "),i+=" if (!"+h+") {   var err =   ",!1!==e.createErrors?(i+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { failingKeyword: "+P+" } ",!1!==e.opts.messages&&(i+=" , message: 'should match \"' + "+P+" + '\" schema' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+=" }   ",c&&(i+=" else { "),i=e.util.cleanUpCode(i)}else c&&(i+=" if (true) { ");return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="valid"+a,u="errs__"+a,d=e.util.copy(e),f="";d.level++;var m="valid"+d.level,v="i"+a,y=d.dataLevel=e.dataLevel+1,g="data"+y,b=e.baseId;if(i+="var "+u+" = errors;var "+h+";",Array.isArray(o)){var P=e.schema.additionalItems;if(!1===P){i+=" "+h+" = "+p+".length <= "+o.length+"; ";var E=l;l=e.errSchemaPath+"/additionalItems",i+="  if (!"+h+") {   ";var x=x||[];x.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+o.length+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var w=i;i=x.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+w+"]); ":i+=" validate.errors = ["+w+"]; return false; ":i+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",l=E,c&&(f+="}",i+=" else { ")}var _=o;if(_)for(var S,$=-1,j=_.length-1;$<j;)if(S=_[$+=1],e.opts.strictKeywords?"object"==typeof S&&Object.keys(S).length>0:e.util.schemaHasRules(S,e.RULES.all)){i+=" "+m+" = true; if ("+p+".length > "+$+") { ";var A=p+"["+$+"]";d.schema=S,d.schemaPath=n+"["+$+"]",d.errSchemaPath=l+"/"+$,d.errorPath=e.util.getPathExpr(e.errorPath,$,e.opts.jsonPointers,!0),d.dataPathArr[y]=$;var T=e.validate(d);d.baseId=b,e.util.varOccurences(T,g)<2?i+=" "+e.util.varReplace(T,g,A)+" ":i+=" var "+g+" = "+A+"; "+T+" ",i+=" }  ",c&&(i+=" if ("+m+") { ",f+="}")}"object"==typeof P&&(e.opts.strictKeywords?"object"==typeof P&&Object.keys(P).length>0:e.util.schemaHasRules(P,e.RULES.all))&&(d.schema=P,d.schemaPath=e.schemaPath+".additionalItems",d.errSchemaPath=e.errSchemaPath+"/additionalItems",i+=" "+m+" = true; if ("+p+".length > "+o.length+") {  for (var "+v+" = "+o.length+"; "+v+" < "+p+".length; "+v+"++) { ",d.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0),A=p+"["+v+"]",d.dataPathArr[y]=v,T=e.validate(d),d.baseId=b,e.util.varOccurences(T,g)<2?i+=" "+e.util.varReplace(T,g,A)+" ":i+=" var "+g+" = "+A+"; "+T+" ",c&&(i+=" if (!"+m+") break; "),i+=" } }  ",c&&(i+=" if ("+m+") { ",f+="}"))}else(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all))&&(d.schema=o,d.schemaPath=n,d.errSchemaPath=l,i+="  for (var "+v+" = 0; "+v+" < "+p+".length; "+v+"++) { ",d.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0),A=p+"["+v+"]",d.dataPathArr[y]=v,T=e.validate(d),d.baseId=b,e.util.varOccurences(T,g)<2?i+=" "+e.util.varReplace(T,g,A)+" ":i+=" var "+g+" = "+A+"; "+T+" ",c&&(i+=" if (!"+m+") break; "),i+=" }");return c&&(i+=" "+f+" if ("+u+" == errors) {"),e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,h="data"+(o||""),u=e.opts.$data&&n&&n.$data;u?(a+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",i="schema"+s):i=n,a+="var division"+s+";if (",u&&(a+=" "+i+" !== undefined && ( typeof "+i+" != 'number' || "),a+=" (division"+s+" = "+h+" / "+i+", ",e.opts.multipleOfPrecision?a+=" Math.abs(Math.round(division"+s+") - division"+s+") > 1e-"+e.opts.multipleOfPrecision+" ":a+=" division"+s+" !== parseInt(division"+s+") ",a+=" ) ",u&&(a+="  )  "),a+=" ) {   ";var d=d||[];d.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+i+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be multiple of ",a+=u?"' + "+i:i+"'"),e.opts.verbose&&(a+=" , schema:  ",a+=u?"validate.schema"+l:""+n,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var f=a;return a=d.pop(),!e.compositeRule&&p?e.async?a+=" throw new ValidationError(["+f+"]); ":a+=" validate.errors = ["+f+"]; return false; ":a+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",p&&(a+=" else { "),a}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="errs__"+a,u=e.util.copy(e);u.level++;var d="valid"+u.level;if(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){u.schema=o,u.schemaPath=n,u.errSchemaPath=l,i+=" var "+h+" = errors;  ";var f,m=e.compositeRule;e.compositeRule=u.compositeRule=!0,u.createErrors=!1,u.opts.allErrors&&(f=u.opts.allErrors,u.opts.allErrors=!1),i+=" "+e.validate(u)+" ",u.createErrors=!0,f&&(u.opts.allErrors=f),e.compositeRule=u.compositeRule=m,i+=" if ("+d+") {   ";var v=v||[];v.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be valid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var y=i;i=v.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(i+=" } ")}else i+="  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be valid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(i+=" if (false) { ");return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="valid"+a,u="errs__"+a,d=e.util.copy(e),f="";d.level++;var m="valid"+d.level,v=d.baseId,y="prevValid"+a,g="passingSchemas"+a;i+="var "+u+" = errors , "+y+" = false , "+h+" = false , "+g+" = null; ";var b=e.compositeRule;e.compositeRule=d.compositeRule=!0;var P=o;if(P)for(var E,x=-1,w=P.length-1;x<w;)E=P[x+=1],(e.opts.strictKeywords?"object"==typeof E&&Object.keys(E).length>0:e.util.schemaHasRules(E,e.RULES.all))?(d.schema=E,d.schemaPath=n+"["+x+"]",d.errSchemaPath=l+"/"+x,i+="  "+e.validate(d)+" ",d.baseId=v):i+=" var "+m+" = true; ",x&&(i+=" if ("+m+" && "+y+") { "+h+" = false; "+g+" = ["+g+", "+x+"]; } else { ",f+="}"),i+=" if ("+m+") { "+h+" = "+y+" = true; "+g+" = "+x+"; }";return e.compositeRule=d.compositeRule=b,i+=f+"if (!"+h+") {   var err =   ",!1!==e.createErrors?(i+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { passingSchemas: "+g+" } ",!1!==e.opts.messages&&(i+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),i+="} else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; }",e.opts.allErrors&&(i+=" } "),i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,h="data"+(o||""),u=e.opts.$data&&n&&n.$data;u?(a+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",i="schema"+s):i=n,a+="if ( ",u&&(a+=" ("+i+" !== undefined && typeof "+i+" != 'string') || "),a+=" !"+(u?"(new RegExp("+i+"))":e.usePattern(n))+".test("+h+") ) {   ";var d=d||[];d.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",a+=u?""+i:""+e.util.toQuotedString(n),a+="  } ",!1!==e.opts.messages&&(a+=" , message: 'should match pattern \"",a+=u?"' + "+i+" + '":""+e.util.escapeQuotes(n),a+="\"' "),e.opts.verbose&&(a+=" , schema:  ",a+=u?"validate.schema"+l:""+e.util.toQuotedString(n),a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var f=a;return a=d.pop(),!e.compositeRule&&p?e.async?a+=" throw new ValidationError(["+f+"]); ":a+=" validate.errors = ["+f+"]; return false; ":a+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+="} ",p&&(a+=" else { "),a}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="errs__"+a,u=e.util.copy(e),d="";u.level++;var f="valid"+u.level,m="key"+a,v="idx"+a,y=u.dataLevel=e.dataLevel+1,g="data"+y,b="dataProperties"+a,P=Object.keys(o||{}),E=e.schema.patternProperties||{},x=Object.keys(E),w=e.schema.additionalProperties,_=P.length||x.length,S=!1===w,$="object"==typeof w&&Object.keys(w).length,j=e.opts.removeAdditional,A=S||$||j,T=e.opts.ownProperties,I=e.baseId,O=e.schema.required;if(O&&(!e.opts.$data||!O.$data)&&O.length<e.opts.loopRequired)var F=e.util.toHash(O);if(i+="var "+h+" = errors;var "+f+" = true;",T&&(i+=" var "+b+" = undefined;"),A){if(i+=T?" "+b+" = "+b+" || Object.keys("+p+"); for (var "+v+"=0; "+v+"<"+b+".length; "+v+"++) { var "+m+" = "+b+"["+v+"]; ":" for (var "+m+" in "+p+") { ",_){if(i+=" var isAdditional"+a+" = !(false ",P.length)if(P.length>8)i+=" || validate.schema"+n+".hasOwnProperty("+m+") ";else{var k=P;if(k)for(var D=-1,C=k.length-1;D<C;)W=k[D+=1],i+=" || "+m+" == "+e.util.toQuotedString(W)+" "}if(x.length){var R=x;if(R)for(var L=-1,q=R.length-1;L<q;)ae=R[L+=1],i+=" || "+e.usePattern(ae)+".test("+m+") "}i+=" ); if (isAdditional"+a+") { "}if("all"==j)i+=" delete "+p+"["+m+"]; ";else{var M=e.errorPath,N="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),S)if(j)i+=" delete "+p+"["+m+"]; ";else{i+=" "+f+" = false; ";var z=l;l=e.errSchemaPath+"/additionalProperties",(te=te||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { additionalProperty: '"+N+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is an invalid additional property":i+="should NOT have additional properties",i+="' "),e.opts.verbose&&(i+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var V=i;i=te.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+V+"]); ":i+=" validate.errors = ["+V+"]; return false; ":i+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=z,c&&(i+=" break; ")}else if($)if("failing"==j){i+=" var "+h+" = errors;  ";var U=e.compositeRule;e.compositeRule=u.compositeRule=!0,u.schema=w,u.schemaPath=e.schemaPath+".additionalProperties",u.errSchemaPath=e.errSchemaPath+"/additionalProperties",u.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var B=p+"["+m+"]";u.dataPathArr[y]=m;var K=e.validate(u);u.baseId=I,e.util.varOccurences(K,g)<2?i+=" "+e.util.varReplace(K,g,B)+" ":i+=" var "+g+" = "+B+"; "+K+" ",i+=" if (!"+f+") { errors = "+h+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+p+"["+m+"]; }  ",e.compositeRule=u.compositeRule=U}else u.schema=w,u.schemaPath=e.schemaPath+".additionalProperties",u.errSchemaPath=e.errSchemaPath+"/additionalProperties",u.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers),B=p+"["+m+"]",u.dataPathArr[y]=m,K=e.validate(u),u.baseId=I,e.util.varOccurences(K,g)<2?i+=" "+e.util.varReplace(K,g,B)+" ":i+=" var "+g+" = "+B+"; "+K+" ",c&&(i+=" if (!"+f+") break; ");e.errorPath=M}_&&(i+=" } "),i+=" }  ",c&&(i+=" if ("+f+") { ",d+="}")}var H=e.opts.useDefaults&&!e.compositeRule;if(P.length){var Q=P;if(Q)for(var W,G=-1,J=Q.length-1;G<J;){var Z=o[W=Q[G+=1]];if(e.opts.strictKeywords?"object"==typeof Z&&Object.keys(Z).length>0:e.util.schemaHasRules(Z,e.RULES.all)){var Y=e.util.getProperty(W),X=(B=p+Y,H&&void 0!==Z.default);if(u.schema=Z,u.schemaPath=n+Y,u.errSchemaPath=l+"/"+e.util.escapeFragment(W),u.errorPath=e.util.getPath(e.errorPath,W,e.opts.jsonPointers),u.dataPathArr[y]=e.util.toQuotedString(W),K=e.validate(u),u.baseId=I,e.util.varOccurences(K,g)<2){K=e.util.varReplace(K,g,B);var ee=B}else ee=g,i+=" var "+g+" = "+B+"; ";if(X)i+=" "+K+" ";else{if(F&&F[W]){i+=" if ( "+ee+" === undefined ",T&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(W)+"') "),i+=") { "+f+" = false; ",M=e.errorPath,z=l;var te,re=e.util.escapeQuotes(W);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(M,W,e.opts.jsonPointers)),l=e.errSchemaPath+"/required",(te=te||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+re+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+re+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",V=i,i=te.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+V+"]); ":i+=" validate.errors = ["+V+"]; return false; ":i+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=z,e.errorPath=M,i+=" } else { "}else c?(i+=" if ( "+ee+" === undefined ",T&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(W)+"') "),i+=") { "+f+" = true; } else { "):(i+=" if ("+ee+" !== undefined ",T&&(i+=" &&   Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(W)+"') "),i+=" ) { ");i+=" "+K+" } "}}c&&(i+=" if ("+f+") { ",d+="}")}}if(x.length){var ie=x;if(ie)for(var ae,se=-1,oe=ie.length-1;se<oe;)Z=E[ae=ie[se+=1]],(e.opts.strictKeywords?"object"==typeof Z&&Object.keys(Z).length>0:e.util.schemaHasRules(Z,e.RULES.all))&&(u.schema=Z,u.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ae),u.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ae),i+=T?" "+b+" = "+b+" || Object.keys("+p+"); for (var "+v+"=0; "+v+"<"+b+".length; "+v+"++) { var "+m+" = "+b+"["+v+"]; ":" for (var "+m+" in "+p+") { ",i+=" if ("+e.usePattern(ae)+".test("+m+")) { ",u.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers),B=p+"["+m+"]",u.dataPathArr[y]=m,K=e.validate(u),u.baseId=I,e.util.varOccurences(K,g)<2?i+=" "+e.util.varReplace(K,g,B)+" ":i+=" var "+g+" = "+B+"; "+K+" ",c&&(i+=" if (!"+f+") break; "),i+=" } ",c&&(i+=" else "+f+" = true; "),i+=" }  ",c&&(i+=" if ("+f+") { ",d+="}"))}return c&&(i+=" "+d+" if ("+h+" == errors) {"),e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="errs__"+a,u=e.util.copy(e);u.level++;var d="valid"+u.level;if(i+="var "+h+" = errors;",e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){u.schema=o,u.schemaPath=n,u.errSchemaPath=l;var f="key"+a,m="idx"+a,v="i"+a,y="' + "+f+" + '",g="data"+(u.dataLevel=e.dataLevel+1),b="dataProperties"+a,P=e.opts.ownProperties,E=e.baseId;P&&(i+=" var "+b+" = undefined; "),i+=P?" "+b+" = "+b+" || Object.keys("+p+"); for (var "+m+"=0; "+m+"<"+b+".length; "+m+"++) { var "+f+" = "+b+"["+m+"]; ":" for (var "+f+" in "+p+") { ",i+=" var startErrs"+a+" = errors; ";var x=f,w=e.compositeRule;e.compositeRule=u.compositeRule=!0;var _=e.validate(u);u.baseId=E,e.util.varOccurences(_,g)<2?i+=" "+e.util.varReplace(_,g,x)+" ":i+=" var "+g+" = "+x+"; "+_+" ",e.compositeRule=u.compositeRule=w,i+=" if (!"+d+") { for (var "+v+"=startErrs"+a+"; "+v+"<errors; "+v+"++) { vErrors["+v+"].propertyName = "+f+"; }   var err =   ",!1!==e.createErrors?(i+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { propertyName: '"+y+"' } ",!1!==e.opts.messages&&(i+=" , message: 'property name \\'"+y+"\\' is invalid' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; "),c&&(i+=" break; "),i+=" } }"}return c&&(i+="  if ("+h+" == errors) {"),e.util.cleanUpCode(i)}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i=" ",a=e.level,s=e.dataLevel,o=e.schema[t],n=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,p="data"+(s||""),h="valid"+a,u=e.opts.$data&&o&&o.$data;u&&(i+=" var schema"+a+" = "+e.util.getData(o.$data,s,e.dataPathArr)+"; ");var d="schema"+a;if(!u)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var f=[],m=o;if(m)for(var v,y=-1,g=m.length-1;y<g;){v=m[y+=1];var b=e.schema.properties[v];b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0:e.util.schemaHasRules(b,e.RULES.all))||(f[f.length]=v)}}else f=o;if(u||f.length){var P=e.errorPath,E=u||f.length>=e.opts.loopRequired,x=e.opts.ownProperties;if(c)if(i+=" var missing"+a+"; ",E){u||(i+=" var "+d+" = validate.schema"+n+"; ");var w="' + "+(T="schema"+a+"["+(j="i"+a)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(P,T,e.opts.jsonPointers)),i+=" var "+h+" = true; ",u&&(i+=" if (schema"+a+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+a+")) "+h+" = false; else {"),i+=" for (var "+j+" = 0; "+j+" < "+d+".length; "+j+"++) { "+h+" = "+p+"["+d+"["+j+"]] !== undefined ",x&&(i+=" &&   Object.prototype.hasOwnProperty.call("+p+", "+d+"["+j+"]) "),i+="; if (!"+h+") break; } ",u&&(i+="  }  "),i+="  if (!"+h+") {   ",(S=S||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+w+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ";var _=i;i=S.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+_+"]); ":i+=" validate.errors = ["+_+"]; return false; ":i+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { "}else{i+=" if ( ";var S,$=f;if($)for(var j=-1,A=$.length-1;j<A;)O=$[j+=1],j&&(i+=" || "),i+=" ( ( "+(C=p+(D=e.util.getProperty(O)))+" === undefined ",x&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(O)+"') "),i+=") && (missing"+a+" = "+e.util.toQuotedString(e.opts.jsonPointers?O:D)+") ) ";i+=") {  ",w="' + "+(T="missing"+a)+" + '",e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(P,T,!0):P+" + "+T),(S=S||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+w+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",_=i,i=S.pop(),!e.compositeRule&&c?e.async?i+=" throw new ValidationError(["+_+"]); ":i+=" validate.errors = ["+_+"]; return false; ":i+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else { "}else if(E){var T;u||(i+=" var "+d+" = validate.schema"+n+"; "),w="' + "+(T="schema"+a+"["+(j="i"+a)+"]")+" + '",e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(P,T,e.opts.jsonPointers)),u&&(i+=" if ("+d+" && !Array.isArray("+d+")) {  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+w+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+d+" !== undefined) { "),i+=" for (var "+j+" = 0; "+j+" < "+d+".length; "+j+"++) { if ("+p+"["+d+"["+j+"]] === undefined ",x&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", "+d+"["+j+"]) "),i+=") {  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+w+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",u&&(i+="  }  ")}else{var I=f;if(I)for(var O,F=-1,k=I.length-1;F<k;){O=I[F+=1];var D=e.util.getProperty(O),C=(w=e.util.escapeQuotes(O),p+D);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(P,O,e.opts.jsonPointers)),i+=" if ( "+C+" === undefined ",x&&(i+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(O)+"') "),i+=") {  var err =   ",!1!==e.createErrors?(i+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(i+=" , message: '",e.opts._errorDataPathProperty?i+="is a required property":i+="should have required property \\'"+w+"\\'",i+="' "),e.opts.verbose&&(i+=" , schema: validate.schema"+n+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=P}else c&&(i+=" if (true) {");return i}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a=" ",s=e.level,o=e.dataLevel,n=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,h="data"+(o||""),u="valid"+s,d=e.opts.$data&&n&&n.$data;if(d?(a+=" var schema"+s+" = "+e.util.getData(n.$data,o,e.dataPathArr)+"; ",i="schema"+s):i=n,(n||d)&&!1!==e.opts.uniqueItems){d&&(a+=" var "+u+"; if ("+i+" === false || "+i+" === undefined) "+u+" = true; else if (typeof "+i+" != 'boolean') "+u+" = false; else { "),a+=" var i = "+h+".length , "+u+" = true , j; if (i > 1) { ";var f=e.schema.items&&e.schema.items.type,m=Array.isArray(f);if(!f||"object"==f||"array"==f||m&&(f.indexOf("object")>=0||f.indexOf("array")>=0))a+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+h+"[i], "+h+"[j])) { "+u+" = false; break outer; } } } ";else{a+=" var itemIndices = {}, item; for (;i--;) { var item = "+h+"[i]; ";var v="checkDataType"+(m?"s":"");a+=" if ("+e.util[v](f,"item",!0)+") continue; ",m&&(a+=" if (typeof item == 'string') item = '\"' + item; "),a+=" if (typeof itemIndices[item] == 'number') { "+u+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}a+=" } ",d&&(a+="  }  "),a+=" if (!"+u+") {   ";var y=y||[];y.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(a+=" , schema:  ",a+=d?"validate.schema"+l:""+n,a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),a+=" } "):a+=" {} ";var g=a;a=y.pop(),!e.compositeRule&&p?e.async?a+=" throw new ValidationError(["+g+"]); ":a+=" validate.errors = ["+g+"]; return false; ":a+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",p&&(a+=" else { ")}else p&&(a+=" if (true) { ");return a}},function(e,t,r){"use strict";var i=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,t){for(var r=0;r<t.length;r++){e=JSON.parse(JSON.stringify(e));var a,s=t[r].split("/"),o=e;for(a=1;a<s.length;a++)o=o[s[a]];for(a=0;a<i.length;a++){var n=i[a],l=o[n];l&&(o[n]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]})}}return e}},function(e,t,r){"use strict";var i=r(3).MissingRef;e.exports=function e(t,r,a){var s=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof r&&(a=r,r=void 0);var o=n(t).then((function(){var e=s._addSchema(t,void 0,r);return e.validate||function e(t){try{return s._compile(t)}catch(e){if(e instanceof i)return a(e);throw e}function a(i){var a=i.missingSchema;if(c(a))throw new Error("Schema "+a+" is loaded but "+i.missingRef+" cannot be resolved");var o=s._loadingSchemas[a];return o||(o=s._loadingSchemas[a]=s._opts.loadSchema(a)).then(l,l),o.then((function(e){if(!c(a))return n(e).then((function(){c(a)||s.addSchema(e,a,void 0,r)}))})).then((function(){return e(t)}));function l(){delete s._loadingSchemas[a]}function c(e){return s._refs[e]||s._schemas[e]}}}(e)}));return a&&o.then((function(e){a(null,e)}),a),o;function n(t){var r=t.$schema;return r&&!s.getSchema(r)?e.call(s,{$ref:r},!0):Promise.resolve()}}},function(e,t,r){"use strict";var i=/^[a-z_$][a-z0-9_$-]*$/i,a=r(45),s=r(46);e.exports={add:function(e,t){var r=this.RULES;if(r.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!i.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var s=t.type;if(Array.isArray(s))for(var o=0;o<s.length;o++)l(e,s[o],t);else l(e,s,t);var n=t.metaSchema;n&&(t.$data&&this._opts.$data&&(n={anyOf:[n,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(n,!0))}function l(e,t,i){for(var s,o=0;o<r.length;o++){var n=r[o];if(n.type==t){s=n;break}}s||(s={type:t,rules:[]},r.push(s));var l={keyword:e,definition:i,custom:!0,code:a,implements:i.implements};s.rules.push(l),r.custom[e]=l}return r.keywords[e]=r.all[e]=!0,this},get:function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var i=t[r].rules,a=0;a<i.length;a++)if(i[a].keyword==e){i.splice(a,1);break}return this},validate:function e(t,r){e.errors=null;var i=this._validateKeyword=this._validateKeyword||this.compile(s,!0);if(i(t))return!0;if(e.errors=i.errors,r)throw new Error("custom keyword definition is invalid: "+this.errorsText(i.errors));return!1}}},function(e,t,r){"use strict";e.exports=function(e,t,r){var i,a,s=" ",o=e.level,n=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),p=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(n||""),d="valid"+o,f="errs__"+o,m=e.opts.$data&&l&&l.$data;m?(s+=" var schema"+o+" = "+e.util.getData(l.$data,n,e.dataPathArr)+"; ",a="schema"+o):a=l;var v,y,g,b,P,E="definition"+o,x=this.definition,w="";if(m&&x.$data){P="keywordValidate"+o;var _=x.validateSchema;s+=" var "+E+" = RULES.custom['"+t+"'].definition; var "+P+" = "+E+".validate;"}else{if(!(b=e.useCustomRule(this,l,e.schema,e)))return;a="validate.schema"+c,P=b.code,v=x.compile,y=x.inline,g=x.macro}var S=P+".errors",$="i"+o,j="ruleErr"+o,A=x.async;if(A&&!e.async)throw new Error("async keyword in sync schema");if(y||g||(s+=S+" = null;"),s+="var "+f+" = errors;var "+d+";",m&&x.$data&&(w+="}",s+=" if ("+a+" === undefined) { "+d+" = true; } else { ",_&&(w+="}",s+=" "+d+" = "+E+".validateSchema("+a+"); if ("+d+") { ")),y)x.statements?s+=" "+b.validate+" ":s+=" "+d+" = "+b.validate+"; ";else if(g){var T=e.util.copy(e);w="",T.level++;var I="valid"+T.level;T.schema=b.validate,T.schemaPath="";var O=e.compositeRule;e.compositeRule=T.compositeRule=!0;var F=e.validate(T).replace(/validate\.schema/g,P);e.compositeRule=T.compositeRule=O,s+=" "+F}else{(R=R||[]).push(s),s="",s+="  "+P+".call( ",e.opts.passContext?s+="this":s+="self",v||!1===x.schema?s+=" , "+u+" ":s+=" , "+a+" , "+u+" , validate.schema"+e.schemaPath+" ",s+=" , (dataPath || '')",'""'!=e.errorPath&&(s+=" + "+e.errorPath);var k=n?"data"+(n-1||""):"parentData",D=n?e.dataPathArr[n]:"parentDataProperty",C=s+=" , "+k+" , "+D+" , rootData )  ";s=R.pop(),!1===x.errors?(s+=" "+d+" = ",A&&(s+="await "),s+=C+"; "):s+=A?" var "+(S="customErrors"+o)+" = null; try { "+d+" = await "+C+"; } catch (e) { "+d+" = false; if (e instanceof ValidationError) "+S+" = e.errors; else throw e; } ":" "+S+" = null; "+d+" = "+C+"; "}if(x.modifying&&(s+=" if ("+k+") "+u+" = "+k+"["+D+"];"),s+=""+w,x.valid)h&&(s+=" if (true) { ");else{var R;s+=" if ( ",void 0===x.valid?(s+=" !",s+=g?""+I:""+d):s+=" "+!x.valid+" ",s+=") { ",i=this.keyword,(R=R||[]).push(s),s="",(R=R||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(i||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(s+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),s+=" } "):s+=" {} ";var L=s;s=R.pop(),!e.compositeRule&&h?e.async?s+=" throw new ValidationError(["+L+"]); ":s+=" validate.errors = ["+L+"]; return false; ":s+=" var err = "+L+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var q=s;s=R.pop(),y?x.errors?"full"!=x.errors&&(s+="  for (var "+$+"="+f+"; "+$+"<errors; "+$+"++) { var "+j+" = vErrors["+$+"]; if ("+j+".dataPath === undefined) "+j+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+j+".schemaPath === undefined) { "+j+'.schemaPath = "'+p+'"; } ',e.opts.verbose&&(s+=" "+j+".schema = "+a+"; "+j+".data = "+u+"; "),s+=" } "):!1===x.errors?s+=" "+q+" ":(s+=" if ("+f+" == errors) { "+q+" } else {  for (var "+$+"="+f+"; "+$+"<errors; "+$+"++) { var "+j+" = vErrors["+$+"]; if ("+j+".dataPath === undefined) "+j+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+j+".schemaPath === undefined) { "+j+'.schemaPath = "'+p+'"; } ',e.opts.verbose&&(s+=" "+j+".schema = "+a+"; "+j+".data = "+u+"; "),s+=" } } "):g?(s+="   var err =   ",!1!==e.createErrors?(s+=" { keyword: '"+(i||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(s+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),s+=" } "):s+=" {} ",s+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?s+=" throw new ValidationError(vErrors); ":s+=" validate.errors = vErrors; return false; ")):!1===x.errors?s+=" "+q+" ":(s+=" if (Array.isArray("+S+")) { if (vErrors === null) vErrors = "+S+"; else vErrors = vErrors.concat("+S+"); errors = vErrors.length;  for (var "+$+"="+f+"; "+$+"<errors; "+$+"++) { var "+j+" = vErrors["+$+"]; if ("+j+".dataPath === undefined) "+j+".dataPath = (dataPath || '') + "+e.errorPath+";  "+j+'.schemaPath = "'+p+'";  ',e.opts.verbose&&(s+=" "+j+".schema = "+a+"; "+j+".data = "+u+"; "),s+=" } } else { "+q+" } "),s+=" } ",h&&(s+=" else { ")}return s}},function(e,t,r){"use strict";var i=r(11);e.exports={$id:"https://github.com/epoberezkin/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:i.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:i.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON Schema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},function(e,t,r){let a=r(49);const s="#d5cdea",o=(e,t)=>e.replace(new RegExp(`(?![^\\n]{1,${t}}$)([^\\n]{1,${t}})\\s`,"g"),"$1\n");function n(e,t,r,i,a){let s=f(i);return e.nodes.push({id:s,label:"Location: "+i,longLabel:"Location: "+i,type:"circle",x:t.x,y:t.y,size:1,color:"#3aa5d2"}),void 0!==a&&e.edges.push({id:m(a,s),source:a,target:s,size:1}),r+.1}function l(e,t,r,i,s,n,l){let h=d(n),u="Scene: "+n.name,f=u+"\n\n"+o(n.description,u.length);if(e.nodes.push({id:h,label:u,longLabel:f,type:"circle",x:r.x,y:s,size:1,color:"#8ecce6",obj:n}),s+=.1,void 0!==l){let t=g(n.emotionalRequirements,n.priority);e.edges.push({id:m(l,h),label:t,source:l,target:h,size:1})}let v=function(e,t){let r=t.events,i=t.firstEvents,a=[];for(eventName of i){let i=r.find(e=>e.name===eventName);void 0===i?b(e,"Undefined first event: First event "+eventName+" in scene "+t.name+" is undefined"):a.push(i)}return a}(t,n),y={x:i,y:s};for(event of v)c(e,t,n,event,y),y.x+=.1;let P=function(e,t){let r=t.events,i=[];for(event of r){let t,s=new a,o=[],n=[];for(s.push(event);!s.isEmpty();){t=s.pop(),o.push(t.name),n.push(t.name);let a=p(e,t,r);for(nextEvent of a){if(nextEvent.name==event.name){let e=[...n];e.push(nextEvent.name),i.push(e)}o.includes(nextEvent.name)||s.push(nextEvent)}}}if(0==i.length)return i;let s=[];s.push(i[0]);for(let e=0;e<i.length;e++){let t=!0,r=[...i[e]];r.sort();for(let e=0;e<s.length;e++)if(r.length==s[e].length){let i=[...s[e]];if(i.sort(),JSON.stringify(r)==JSON.stringify(i)){t=!1;break}}t&&s.push(i[e])}return s}(t,n);if(0!=P.length)for(cyclePath of P)b(t,"Cycle: There is a cycle in scene "+n.name+" with path: "+cyclePath);r.x=y.x}function c(e,t,r,i,o){let n,l=o.y,c=r.events,f=new a,b=[];for(f.push(i);!f.isEmpty();){n=f.pop(),b.push(n.name);let i=h(n);if(u(n,r)){let t=g(n.emotionalRequirements,n.priority),a=m(d(r),i.id);y(e,a)||e.edges.push({id:a,label:t,source:d(r),target:i.id,size:1})}v(e,i.id)||(e.nodes.push({id:i.id,label:i.label,longLabel:i.longLabel,type:i.type,x:o.x,y:l,size:1,color:i.color,obj:n}),l+=.1);let a=p(t,n,c);for(nextEvent of a){b.includes(nextEvent.name)||f.push(nextEvent);let t=h(nextEvent),r=g(nextEvent.emotionalRequirements,nextEvent.priority),a=m(i.id,t.id);y(e,a)||e.edges.push({id:a,label:r,source:i.id,target:t.id,size:1,color:s})}}o.x+=.1}function p(e,t,r){let i=[];for(eventName of t.nextEvents){let a=r.find(e=>e.name===eventName);void 0===a?b(e,"Undefined next event: Next event "+eventName+" in "+t.name+" is undefined"):i.push(a)}return i}function h(e){let t={type:"cross",color:"#fcf8e9",id:"",label:"",longLabel:""};return"cutscene"==e.type?(t.label="Cutscene: ",t.type="square",t.color=s,t.id="cutscene_"):"gameplay"==e.type&&(t.label="Gameplay: ",t.type="diamond",t.color="#fae2ef",t.id="gameplay_"),t.id+=e.name,t.label+=e.name,t.longLabel=t.label+"\n\n"+o(e.description,t.label.length),t}function u(e,t){return t.firstEvents.includes(e.name)}function d(e){return"scene_"+e.name}function f(e){return"location_"+e}function m(e,t){return"edge_"+e+"_"+t}function v(e,t){return void 0!==e.nodes.find(e=>e.id===t)}function y(e,t){return void 0!==e.edges.find(e=>e.id===t)}function g(e,t){let r="default";if(0!=e.length)for([i,requirement]of(r="",e.entries()))r+=requirement.parameter+" "+requirement.condition+" "+requirement.value,i!=e.length-1&&(r+="&& ");return r="(priority: "+t+") "+r,r}function b(e,t){e.includes(t)||e.push(t)}e.exports=function(e){let t=[],r={nodes:[],edges:[]},i={x:0,y:0};r.nodes.push({id:"start",label:"Start",longLabel:"Start",type:"star",x:i.x,y:i.y,size:1,color:"#d0d5db"}),i.y+=.1;const a=e.scenes.filter(t=>e.firstLocation===t.locationId);0==a.length&&b(t,"No first location scenes: No scenes have a location id corresponding to the first location");let s=function(e,t){let r=[];for(scene of(t&&r.push(e.firstLocation),e.scenes))r.includes(scene.locationId)||r.push(scene.locationId);return r}(e,0!=a.length);for(locationId of s){let a=0;a=locationId==e.firstLocation?n(r,i,i.y,locationId,"start"):n(r,i,i.y,locationId);let s=e.scenes.filter(e=>locationId===e.locationId);for(scene of s)l(r,t,i,i.x,a,scene,f(locationId))}return{graph:r,errors:t}}},function(e,t){e.exports=class{constructor(){this.data=[],this.top=0}push(e){this.data[this.top]=e,this.top=this.top+1}length(){return this.top}peek(){return this.data[this.top-1]}isEmpty(){return 0===this.top}pop(){if(!1===this.isEmpty())return this.top=this.top-1,this.data.pop()}print(){for(var e=this.top-1;e>=0;)console.log(this.data[e]),e--}reverse(){this._reverse(this.top-1)}_reverse(e){0!=e&&this._reverse(e-1),console.log(this.data[e])}}},function(e,t,r){let i=r(51);function a(e){e.sort((e,t)=>e.obj.priority-t.obj.priority)}function s(e,t){let r=function(e,t){return t.edges.filter(t=>t.source===e.id)}(e,t),i=[];for(let e of r)i.push(t.nodes.find(t=>t.id===e.target));return i}function o(e,t,r){let i=[],a=n(t,r,e);for(;null!=a;)i.push(a.obj),a=n(a,r,e);return i}function n(e,t,r){let o=s(e,t);a(o);let n=new i(r);for(let e of o){let t=e.obj;if(n.matches(t.emotionalRequirements))return e}}e.exports=function(e,t){const r={scenes:[]},n=[];let l=function(e,t){let r=s(e.nodes.find(e=>"start"===e.id),e)[0],o=s(r,e);a(o);let n=new i(t);for(let e of o){let t=e.obj;if(n.matches(t.emotionalRequirements))return e}}(t,e);for(sceneNode of(n.push(l),n))sceneNode.obj.events=o(e,sceneNode,t),r.scenes.push(sceneNode.obj);return r}},function(e,t){e.exports=class{constructor(e){this.playerType=e,this.evaluators={">":function(e,t){return e>t},"<":function(e,t){return e<t},">=":function(e,t){return e>=t},"<=":function(e,t){return e<=t},"=":function(e,t){return e==t},"!=":function(e,t){return e!=t}}}matches(e){let t=!0;for(let r of e){let e=this.evaluators[r.condition],i=r.parameter,a=r.value;if(!e(this.playerType[i],a)){t=!1;break}}return t}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://example.com/example.json",type:"object",title:"The Root Schema",description:"The root schema comprises the entire JSON document.",required:["firstLocation","scenes"],properties:{firstLocation:{$id:"#/properties/firstLocation",type:"string",title:"First Location",description:"Which location should be used for first scene",default:"",examples:["salon"]},scenes:{$id:"#/properties/scenes",type:"array",title:"Scenes",description:"An array containing all the possible scenes of the game. Each scene represents a different map in the game",default:[],items:{$id:"#/properties/scenes/items",type:"object",title:"Scene",description:"The overview representation of a scene",default:{},examples:[{locationId:"salon",name:"happySalon",description:"The dance salon looks well lit and nicely decorated with warm colors.",map:"dance_hall",priority:2,emotionalRequirements:[],transitions:[{unlockedOnEventsEnding:["happySalon_3A"],toLocation:"hugeSalon",name:"happySalonToHugeSalon"}],firstEvents:["happySalon_1A","happySalon_1B"],events:[{name:"happySalon_1A",description:"Clara is excited and happy for the Christmas party.",type:"cutscene",priority:2,emotionalRequirements:[],nextEvents:["happySalon_2A","happySalon_3A"]},{name:"happySalon_1B",description:"Clara is happy for the party but is somewhat nervous.",type:"cutscene",priority:1,emotionalRequirements:[{parameter:"anxiety",condition:">",value:8}],nextEvents:["happySalon_2A","happySalon_3A"]},{name:"happySalon_2A",description:"Since she is nervous, she only wants to talk to her Grandma first.",type:"gameplay",priority:1,emotionalRequirements:[{parameter:"anxiety",condition:">",value:8}],nextEvents:["happySalon_3A"]},{name:"happySalon_3A",description:"Time to talk to other guests and check the cake.",type:"gameplay",priority:2,emotionalRequirements:[],nextEvents:[]}]}],required:["locationId","name","description","map","priority","emotionalRequirements","transitions","firstEvents","events"],properties:{locationId:{$id:"#/properties/scenes/items/properties/locationId",type:"string",title:"Location ID",description:"The location to which this scene belongs to.",default:"",examples:["salon"]},name:{$id:"#/properties/scenes/items/properties/name",type:"string",title:"Name",description:"The name/id of the scene. Must be unique",default:"",examples:["scene1A"]},description:{$id:"#/properties/scenes/items/properties/description",type:"string",title:"Description",description:"A small textual description for this scene",default:"",examples:["Small description"]},map:{$id:"#/properties/scenes/items/properties/map",type:"string",title:"Map",description:"The key to the map of this scene",default:"",examples:["dance_hallA"]},priority:{$id:"#/properties/scenes/items/properties/priority",type:"integer",title:"Priority",description:"In case there is a tie in the emotional requirements of the scenes, the framework chooses the one with the highest priority",default:0,examples:[1]},emotionalRequirements:{$id:"#/properties/scenes/items/properties/emotionalRequirements",type:"array",title:"Emotional Requirements",description:"The emotional requirements for this scene to show to the player. This scene will only show to the player if the conditions stated in this array are ALL TRUE",default:[],items:{$id:"#/properties/scenes/items/properties/emotionalRequirements/items",type:"object",title:"Requirement",description:"The representation of an emotional requirement",default:{},examples:[{parameter:"anger",value:8,condition:">="}],required:["parameter","condition","value"],properties:{parameter:{$id:"#/properties/scenes/items/properties/emotionalRequirements/items/properties/parameter",type:"string",title:"Parameter",description:'The name of the parameter(emotion) to be evaluated. Can be "anger", "disgust", "fear", "anxiety", "sadness", "desire", "relaxation" or "happiness"',default:"",examples:["anger","disgust","fear","anxiety","sadness","desire","relaxation"]},condition:{$id:"#/properties/scenes/items/properties/emotionalRequirements/items/properties/condition",type:"string",title:"Condition",description:"Can be >, <, >=, <=, =, !=",default:"",examples:[">="]},value:{$id:"#/properties/scenes/items/properties/emotionalRequirements/items/properties/value",type:"integer",title:"Value",description:"The value to be compared to",default:0,examples:[8]}},patternProperties:{},dependencies:{}}},transitions:{$id:"#/properties/scenes/items/properties/transitions",type:"array",title:"Transitions",description:"List of transitions possible from this scene/map to other scenes and the necessary conditions for these transitions to be available",default:[],items:{$id:"#/properties/scenes/items/properties/transitions/items",type:"object",title:"Transition",description:"Description of a possible transition from scene A to scene B",default:{},examples:[{unlockedOnEventsEnding:["sadSalon_1A","sadSalon_1B"],toLocation:"hugeSalon",name:"sadSalonToHugeSalon"}],required:["toLocation","name"],properties:{name:{$id:"#/properties/scenes/items/properties/transitions/items/properties/name",type:"string",title:"Name",description:"The id/name of this transiction. Must be unique",default:"",examples:["sadSalonToHugeSalon"]},toLocation:{$id:"#/properties/scenes/items/properties/transitions/items/properties/toLocation",type:"string",title:"To Location",description:"The id of the location to transition to",default:"",examples:["scene2A"]},unlockedOnEventsEnding:{$id:"#/properties/scenes/items/properties/transitions/items/properties/unlockedOnEventsEnding",type:"array",title:"Unlocked On Events Ending",description:"Which events'endings trigger the unlocking of the transiction",default:[],items:{$id:"#/properties/scenes/items/properties/transitions/items/properties/unlockedOnEventsEnding/items",type:"string",title:"Event ID",description:"The event ID that enables the transiction after the event ends",default:"",examples:["event1A_1A"],patternProperties:{},dependencies:{}}}},patternProperties:{},dependencies:{}}},firstEvents:{$id:"#/properties/scenes/items/properties/firstEvents",type:"array",title:"First Events",description:"A list of event ids (of this current scene) that can be the first event of the scene",default:[],examples:[["event1A2","event1B2"]],additionalItems:!0,items:{$id:"#/properties/scenes/items/properties/firstEvents/items",type:"string",title:"Event id",description:"The id of the event. Must belong to the same scene.",default:"",examples:["event1A2"]}},events:{$id:"#/properties/scenes/items/properties/events",type:"array",title:"Events",description:"The list of events to take place in the scene. Can be cutscenes or gameplay",default:[],items:{$id:"#/properties/scenes/items/properties/events/items",type:"object",title:"Event",description:"An overview representation of an event",default:{},examples:[{name:"event1A1A",description:"Small description",priority:1,emotionalRequirements:[{value:8,condition:">=",parameter:"anger"}],nextEvents:["event1A2"],type:"cutscene"},{emotionalRequirements:[{value:8,condition:">=",parameter:"anger"}],type:"cutscene",name:"event1A1B",description:"Small description",priority:2,nextEvents:["event1A2"]},{name:"event1A2",description:"Small description",priority:1,emotionalRequirements:[],type:"gameplay",nextEvents:["event1A2"]}],required:["name","description","type","priority","emotionalRequirements","nextEvents"],properties:{name:{$id:"#/properties/scenes/items/properties/events/items/properties/name",type:"string",title:"Name",description:"The name/id of the event. Must be unique. Must match the name (minus the extension) of the file containing the event.",default:"",examples:["event1A1A"]},description:{$id:"#/properties/scenes/items/properties/events/items/properties/description",type:"string",title:"Description",description:"A small textual description of the event",default:"",examples:["Small description"]},type:{$id:"#/properties/scenes/items/properties/events/items/properties/type",type:"string",pattern:"^(cutscene|gameplay)$",title:"Type",description:"Can be cutscene or gameplay",default:"",examples:["cutscene"]},priority:{$id:"#/properties/scenes/items/properties/events/items/properties/priority",type:"integer",title:"Priority",description:"In case there is a tie in the emotional requirements of the scenes, the framework chooses the one with the highest priority",default:0,examples:[1]},emotionalRequirements:{$id:"#/properties/scenes/items/properties/events/items/properties/emotionalRequirements",type:"array",title:"Emotional requirements",description:"The emotional requirements for this event to be available to the player. This event will only show to the player if the conditions stated in this array are ALL TRUE",default:[],items:{$id:"#/properties/scenes/items/properties/events/items/properties/emotionalRequirements/items",type:"object",title:"Requirement",description:"The representation of an emotional requirement",default:{},examples:[{value:8,condition:">=",parameter:"anger"}],required:["parameter","condition","value"],properties:{parameter:{$id:"#/properties/scenes/items/properties/events/items/properties/emotionalRequirements/items/properties/parameter",type:"string",title:"Parameter",description:'The name of the parameter(emotion) to be evaluated. Can be "anger", "disgust", "fear", "anxiety", "sadness", "desire", "relaxation" or "happiness"',default:"",examples:["anger","disgust","fear","anxiety","sadness","desire","relaxation"]},condition:{$id:"#/properties/scenes/items/properties/events/items/properties/emotionalRequirements/items/properties/condition",type:"string",title:"Condition",description:"Can be >, <, >=, <=, =, !=",default:"",examples:[">="]},value:{$id:"#/properties/scenes/items/properties/events/items/properties/emotionalRequirements/items/properties/value",type:"integer",title:"Value",description:"The value to be compared to",default:0,examples:[8]}},patternProperties:{},dependencies:{}}},nextEvents:{$id:"#/properties/scenes/items/properties/events/items/properties/nextEvents",type:"array",title:"Next Events",description:"A list of event ids (of this current scene) that can be the next events occuring after this event",default:[],examples:[["event1A2"]],additionalItems:!0,items:{$id:"#/properties/scenes/items/properties/events/items/properties/nextEvents/items",type:"string",title:"Event id",description:"The id of the event that could happen next. Must belong to the same scene.",default:"",examples:["event1A2"]}}},patternProperties:{},dependencies:{}}}},patternProperties:{},dependencies:{}}}},patternProperties:{},dependencies:{}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://diss2020.com/actors.schema.json",type:"object",title:"Actors",description:"A list of all the actors in the game and their properties",required:["actors"],properties:{actors:{$id:"#/properties/actors",type:"array",title:"Actors",description:"A list of all the actors in the game (protagonists, NPCs, enemies)",items:{$id:"#/properties/actors/items",type:"object",title:"Actor",description:"The representation of an actor",required:["id","name","tilesetId","defaultFrame","animations","body"],properties:{id:{$id:"#/properties/actors/items/properties/id",type:"string",title:"Id",description:"The unique ID for this actor"},name:{$id:"#/properties/actors/items/properties/name",type:"string",title:"Name",description:"The actor's name"},tilesetId:{$id:"#/properties/actors/items/properties/tilesetId",type:"string",title:"Tileset",description:"The name/id of the tileset containing the sprites for this actor"},defaultFrame:{$id:"#/properties/actors/items/properties/initFrame",type:"integer",title:"Init Frame",description:"The default/initial frame of this actor."},animations:{$id:"#/properties/actors/items/properties/animations",type:"array",title:"animations",description:'A list of the animations for the actor. The keys "right", "left", "top" and "down" are reserved for walking animations.',items:{$id:"#/properties/actors/items/properties/animations/items",type:"object",title:"Animation",description:'A representation of an animation. To define walking animations, declare 4 animations with the "right", "left", "top" and "down" keys',required:["key","frames","frameRate","repeat"],properties:{key:{$id:"#/properties/actors/items/properties/animations/items/properties/key",type:"string",title:"Key",description:"The animation key"},frames:{$id:"#/properties/actors/items/properties/animations/items/properties/frames",type:"array",title:"Frames",description:"The frames in the tileset required for the animation",items:{$id:"#/properties/actors/items/properties/animations/items/properties/frames/items",type:"integer",title:"Frame",description:"The index corresponding to the desired frame in the tileset"}},frameRate:{$id:"#/properties/actors/items/properties/animations/items/properties/frameRate",type:"integer",title:"Framerate",description:"The framerate of the animation"},repeat:{$id:"#/properties/actors/items/properties/animations/items/properties/repeat",type:"integer",title:"Repeat",description:"Number of times the animation should repeat. -1 if animation should loop forever"}}}},body:{$id:"#/properties/actors/items/properties/body",type:"object",title:"Body",description:"Description of the physics body of this actor",required:["height","width","anchor"],properties:{height:{$id:"#/properties/actors/items/properties/body/properties/height",type:"integer",title:"Height",description:"The height of the physics body, as a percentage of the height of the sprite.",minimum:1},width:{$id:"#/properties/actors/items/properties/body/properties/width",type:"integer",title:"Width",description:"The width of the physics body, as a percentage of the width of the sprite.",minimum:1},anchor:{$id:"#/properties/actors/items/properties/body/properties/anchor",type:"string",title:"Anchor",description:"The anchor to which the sprite center will be calculated.",pattern:"^((left|right|center)-(top|bottom|center))$"}}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://diss2020.com/cutscene.schema.json",type:"object",title:"Cutscene",description:"The description of a game cutscene",required:["name","actors","actions"],properties:{name:{$id:"#/properties/name",type:"string",title:"Name",description:"The name/id of the event"},actors:{$id:"#/properties/actors",type:"array",title:"Actors",description:"A list of the actors present in the event",items:{$id:"#/properties/actors/items",type:"object",title:"Actor",description:"The id and starting position of the actor",required:["actorId","start"],properties:{actorId:{$id:"#/properties/actors/items/properties/actorId",type:"string",title:"Actor Id",description:"The ID of the actor defined in the actors file"},start:{$id:"#/properties/actors/items/properties/start",type:"array",title:"Start",description:"The starting position of the actor in the map",items:{$id:"#/properties/actors/items/properties/start/items",type:"integer",title:"X, Y",description:"The X and Y position in the map "}}}}},actions:{$id:"#/properties/actions",type:"array",title:"actions",description:"A list of the actions in this event",items:{$id:"#/properties/actions/items",type:"object",title:"Action",description:"The representation of an action",required:["action","arguments","actorId"],properties:{action:{$id:"#/properties/actions/items/properties/action",type:"string",title:"Action",description:'The type of action. For example, it can be "walk" or "talk"'},arguments:{$id:"#/properties/actions/items/properties/arguments",type:"object",title:"Arguments",description:"The arguments for the specific action"},actorId:{$id:"#/properties/actions/items/properties/actor",type:"string",title:"Actor",description:"The actor that should perform the action"}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://diss2020.com/dialogue.schema.json",type:"object",title:"Dialogue",description:"The description of an in-game dialogue",required:["lines"],properties:{lines:{$id:"#/properties/lines",type:"array",title:"Lines",description:"An array of all the dialogue lines, in order of appearance",items:{$id:"#/properties/lines/items",type:"object",title:"Line",description:"The object representation of a line",required:["author","text"],properties:{author:{$id:"#/properties/lines/items/properties/author",type:"string",title:"Author",description:"The author that says the line"},text:{$id:"#/properties/lines/items/properties/text",type:"string",title:"Text",description:"The text of the line"}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://diss2020.com/enemies.schema.json",type:"object",title:"Enemies",description:"A list of all the enemies in the game and their properties",required:["enemies"],properties:{enemies:{$id:"#/properties/enemies",type:"array",title:"Enemies",description:"An array containing all enemies of the game",items:{$id:"#/properties/enemies/items",type:"object",title:"Enemy",description:"The object representation of an enemy",required:["id","hp","mp","attack","defense","speed","moveset","behaviors"],properties:{id:{$id:"#/properties/enemies/items/properties/id",type:"string",title:"Id",description:"The unique Id of the enemy"},hp:{$id:"#/properties/enemies/items/properties/hp",type:"integer",title:"HP",description:"The total Health Points of the enemy"},mp:{$id:"#/properties/enemies/items/properties/mp",type:"integer",title:"MP",description:"The total Magic Points of the enemy"},attack:{$id:"#/properties/enemies/items/properties/attack",type:"integer",title:"Attack",description:"The base attack of the enemy"},defense:{$id:"#/properties/enemies/items/properties/defense",type:"integer",title:"Defense",description:"The defense of the enemy"},speed:{$id:"#/properties/enemies/items/properties/speed",type:"integer",title:"Speed",description:"The speed of the enemy to decide its order in the battle turns. The higher speed, the sooner the enemy acts in the turn"},moveset:{$id:"#/properties/enemies/items/properties/moveset",type:"object",title:"Moveset",description:"A list of all the moves available to this enemy",required:["attacks","buffs"],properties:{attacks:{$id:"#/properties/enemies/items/properties/moveset/properties/attacks",type:"array",title:"Attacks",description:"A list of all the attacks available to the enemy ",items:{$id:"#/properties/enemies/items/properties/moveset/properties/attacks/items",type:"object",title:"Attack",description:"The object representation of an attack",required:["name","power","mpCost","accuracy","target"],properties:{name:{$id:"#/properties/enemies/items/properties/moveset/properties/attacks/items/properties/name",type:"string",title:"Name",description:'The name of the attack. The name "attack" is reserved to the basic attack'},power:{$id:"#/properties/enemies/items/properties/moveset/properties/attacks/items/properties/power",type:"integer",title:"Power",description:"The power of the attack. The damage of this attack is basicAttack*power"},mpCost:{$id:"#/properties/enemies/items/properties/moveset/properties/attacks/items/properties/mpCost",type:"integer",title:"MP cost",description:"The MP cost for this attack"},accuracy:{$id:"#/properties/enemies/items/properties/moveset/properties/attacks/items/properties/accuracy",type:"number",title:"Accuracy",description:"The accuracy of this attack in percentage. If 100% the attack always hits"},target:{$id:"#/properties/enemies/items/properties/moveset/properties/attacks/items/properties/target",type:"string",title:"Target",description:'The target of the attack. If "one" the attacks targets one party member. If "all" the attack targets everyone in the party'}}}},buffs:{$id:"#/properties/enemies/items/properties/moveset/properties/buffs",type:"array",title:"Buffs",description:"The list of possible buffs for this enemy to use in their party",items:{$id:"#/properties/enemies/items/properties/moveset/properties/buffs/items",type:"object",title:"Buff",description:"The object representation of a buff",required:["name","action","arguments","mpCost","target"],properties:{name:{$id:"#/properties/enemies/items/properties/moveset/properties/buffs/items/properties/name",type:"string",title:"Name",description:"The name of the buff"},action:{$id:"#/properties/enemies/items/properties/moveset/properties/buffs/items/properties/action",type:"string",title:"Action",description:"The kind of action this buff does"},arguments:{$id:"#/properties/enemies/items/properties/moveset/properties/buffs/items/properties/arguments",type:"object",title:"Arguments",description:'An object with the list of arguments needed for this action. Example: if "heal" arguments could be "percentage": 30, meaning the amount of health healed',required:["percentage"]},mpCost:{$id:"#/properties/enemies/items/properties/moveset/properties/buffs/items/properties/mpCost",type:"integer",title:"MP Cost",description:"The MP cost for this buff"},target:{$id:"#/properties/enemies/items/properties/moveset/properties/buffs/items/properties/target",type:"string",title:"Target",description:'The target of the buff. If "one" the attacks buffs one party member. If "all" the buff targets everyone in the party'}}}}}},behaviors:{$id:"#/properties/enemies/items/properties/behaviors",type:"array",title:"Behaviors",description:'The "AI" of the enemy: a list of behaviors ordered by priority',items:{$id:"#/properties/enemies/items/properties/behaviors/items",type:"object",title:"Behavior",description:"An object representation of a possible behavior of the enemy",required:["conditions","activation","action"],properties:{conditions:{$id:"#/properties/enemies/items/properties/behaviors/items/properties/conditions",type:"array",title:"Conditions",description:"The activation conditions for the enemy to conduct this behavior",items:{$id:"#/properties/enemies/items/properties/behaviors/items/properties/conditions/items",type:"object",title:"Condition",description:"An object representation of a condition",required:["field","target","operator","percentage"],properties:{field:{$id:"#/properties/enemies/items/properties/behaviors/items/properties/conditions/items/properties/field",type:"string",title:"Field",description:'The field that this behavior will watch. Example: if "hp" this behavior will activate when the "hp" reaches a certain value'},target:{$id:"#/properties/enemies/items/properties/behaviors/items/properties/conditions/items/properties/target",type:"string",title:"Target",description:'The target that contains the field that is being watched. Can be "enemyOne", "enemyAll", "friendOne", "friendAll"'},operator:{$id:"#/properties/enemies/items/properties/behaviors/items/properties/conditions/items/properties/operator",type:"string",title:"Operator",description:"The operator to be used in the comparison of the field being watched and the desired percentage value"},percentage:{$id:"#/properties/enemies/items/properties/behaviors/items/properties/conditions/items/properties/percentage",type:"string",title:"Percentage",description:'The percentage value. Example: if the field being watched is "hp", the operator is "<=" and percentage is "30", this behavior will activate if the hp is less or equal than 30%'}}}},activation:{$id:"#/properties/enemies/items/properties/behaviors/items/properties/activation",type:"integer",title:"Activation",description:"A percentage of activation for this behavior. If the behavior activation: 100 the behavior will always occur if the conditions allow it"},action:{$id:"#/properties/enemies/items/properties/behaviors/items/properties/action",type:"string",title:"Action",description:"The name of the action to take. Can be an attack or a buff"}}}}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://diss2020.com/gameplay.schema.json",type:"object",title:"Gameplay",description:"The description of a game gameplay event",required:["name","flags","endEventCondition","player","enemies","npcs","items"],properties:{name:{$id:"#/properties/name",type:"string",title:"Name",description:"The name/id of the gameplay event. Should be unique"},flags:{$id:"#/properties/flags",type:"array",title:"Flags",description:"The flags that will be used in this gameplay event and their initial values",items:{$id:"#/properties/flags/items",type:"object",title:"Flag initialization",description:"The declaration and initialization of a flag",required:["name","value"],properties:{name:{$id:"#/properties/flags/items/properties/name",type:"string",title:"Name",description:"The flag name. Must be unique from all the flags in this event."},value:{$id:"#/properties/flags/items/properties/value",type:["number","boolean"],title:"Value",description:"The inital value of the flag. Can be a boolean or a number"}}}},endEventCondition:{$id:"#/properties/endEventCondition",type:"string",title:"End Event Condition",description:"The condition for this event to end. Should be a valid expression according to the filtrex parser and containing flags that were previously declared for this event"},player:{$id:"#/properties/player",type:"object",title:"Player",description:"The description of the player character",required:["playerId","actorId","startPosition"],properties:{playerId:{$id:"#/properties/player/properties/playerId",type:"string",title:"Player ID",description:"The Id for this player"},actorId:{$id:"#/properties/player/properties/actorId",type:"string",title:"The actor ID",description:"The id of the actor (previously declared in actors.json) to be used for this player"},startPosition:{$id:"#/properties/player/properties/startPosition",type:["array","string"],title:"Start Position",description:"The start position of the player in the map. Can be the previous position where the player left off in the last event (keyword: current) or coordinates to a specific position",pattern:"^current$",items:{$id:"#/properties/player/properties/startPosition/items",type:"integer",title:"Coordinate",description:"The first element of the array is the X coordinate and the second is the Y coordinate (in map coordinates)"}}}},enemies:{$id:"#/properties/enemies",type:"array",title:"Enemies",description:"The list of possible enemy encounters in this event",items:{$id:"#/properties/enemies/items",type:"object",title:"Enemy encounter",description:"The details of an encounter",required:["id","encounterPercentage"],properties:{id:{$id:"#/properties/enemies/items/properties/id",type:"string",title:"ID",description:"The id of the enemy (previously declared in the enemies.json file) to be encountered"},encounterPercentage:{$id:"#/properties/enemies/items/properties/encounterPercentage",type:"integer",title:"Encounter percentage",description:"The probability of the player finding this enemy of all the enemies available. If there is only one enemy, then the percentage should be 100"}}}},npcs:{$id:"#/properties/npcs",type:"array",title:"NPCs",description:"A list of the NPCs available in this event",items:{$id:"#/properties/npcs/items",type:"object",title:"NPC",description:"The description of the NPC",required:["actorId","position","dialogue","isInteractableConditions","flagChangesAfterInteraction"],properties:{actorId:{$id:"#/properties/npcs/items/properties/actorId",type:"string",title:"Actor ID",description:"The Id of the actor (previously declared in actors.json) to be used for this npc"},position:{$id:"#/properties/npcs/items/properties/position",type:"array",title:"Position",description:"The position of this NPC",items:{$id:"#/properties/npcs/items/properties/position/items",type:"integer",title:"Coordinate",description:"The first element of the array is the X coordinate and the second is the Y coordinate (in map coordinates)"}},dialogue:{$id:"#/properties/npcs/items/properties/dialogue",type:"string",title:"Dialogue",description:"The file containing the dialogue for this NPC"},isInteractableConditions:{$id:"#/properties/npcs/items/properties/isInteractableConditions",type:"string",title:"Is Interactable Conditions",description:"The condition for this npc to be interactable. Should be a valid expression according to the filtrex parser and can contain flags that were previously declared for this event"},flagChangesAfterInteraction:{$id:"#/properties/npcs/items/properties/flagChangesAfterInteraction",type:"array",title:"Flag Changes After Interaction",description:"A list of the flag changes after this interaction",items:{$id:"#/properties/npcs/items/properties/flagChangesAfterInteraction/items",type:"object",title:"Flag change",description:"Which flag and how will it change",required:["name","value"],properties:{id:{$id:"#/properties/npcs/items/properties/flagChangesAfterInteraction/items/properties/name",type:"string",title:"Name",description:"The name of the flag. Should be previously declared in this file"},value:{$id:"#/properties/npcs/items/properties/flagChangesAfterInteraction/items/properties/value",type:"string",title:"Value",description:"The value that the flag should change to. Should be a valid expression according to the filtrex parser and can contain flags that were previously declared for this event"}}}}}}},items:{$id:"#/properties/items",type:"array",title:"Items",description:"A list of the items available in this event",items:{$id:"#/properties/items/items",type:"object",title:"Item",description:"The representation of an item",required:["itemId","position","dialogue","inventoryChange","isInteractableConditions","flagChangesAfterInteraction","disappears"],properties:{itemId:{$id:"#/properties/items/items/properties/itemId",type:"string",title:"Item Id",description:"The id of the item (previously declared in items.json) to be used for this item"},position:{$id:"#/properties/items/items/properties/position",type:"array",title:"Position",description:"The position of this item in the map",items:{$id:"#/properties/items/items/properties/position/items",type:"integer",title:"Coordinate",description:"The first element of the array is the X coordinate and the second is the Y coordinate (in map coordinates)"}},dialogue:{$id:"#/properties/items/items/properties/dialogue",type:"string",title:"Dialogue",description:"The dialogue file containing possible dialogue with this item. Can be null"},inventoryChange:{$id:"#/properties/items/items/properties/inventoryChange",type:"object",title:"Inventory Change",description:"Description of a possible inventory change after interaction with the item",required:["itemId","action"],properties:{itemId:{$id:"#/properties/items/items/properties/inventoryChange/properties/itemId",type:"string",title:"Item ID",description:"The item id (previously declared in inventory_items.json) that will be changed in inventory"},action:{$id:"#/properties/items/items/properties/inventoryChange/properties/action",type:"string",title:"Action",description:'The kind of change to do in the inventory. Can be "+n" or "-n", where n is the number of items added or subtracted'}}},isInteractableConditions:{$id:"#/properties/items/items/properties/isInteractableConditions",type:"string",title:"Is Interactable Conditions",description:"The condition for this item to be interactable. Should be a valid expression according to the filtrex parser and can contain flags that were previously declared for this event"},flagChangesAfterInteraction:{$id:"#/properties/items/items/properties/flagChangesAfterInteraction",type:"array",title:"Flag Changes After Interaction",description:"A list of the flag changes after this interaction",items:{$id:"#/properties/npcs/items/properties/flagChangesAfterInteraction/items",type:"object",title:"Flag change",description:"Which flag and how will it change",required:["name","value"],properties:{id:{$id:"#/properties/npcs/items/properties/flagChangesAfterInteraction/items/properties/name",type:"string",title:"Name",description:"The name of the flag. Should be previously declared in this file"},value:{$id:"#/properties/npcs/items/properties/flagChangesAfterInteraction/items/properties/value",type:"string",title:"Value",description:"The value that the flag should change to. Should be a valid expression according to the filtrex parser and can contain flags that were previously declared for this event"}}}},disappears:{$id:"#/properties/items/items/properties/disappears",type:"boolean",title:"Disappears",description:"A boolean to know if the graphic of the item should disappear from the map if it was interacted with"}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://diss2020.com/items.schema.json",type:"object",title:"Items",description:"A list of all game items that the player can pick and add to the inventory",required:["items"],properties:{items:{$id:"#/properties/items",type:"array",title:"Items",description:"A list of all the items in this game",items:{$id:"#/properties/items/items",type:"object",title:"Item",description:"The description of an item",required:["itemId","name","tileset","frame"],properties:{itemId:{$id:"#/properties/items/items/properties/itemId",type:"string",title:"Item id",description:"The id for this item. Should be unique"},name:{$id:"#/properties/items/items/properties/name",type:"string",title:"Name",description:"The name of this item as seen by the player"},tileset:{$id:"#/properties/items/items/properties/tileset",type:"string",title:"Tileset",description:"The id/name of tileset where the graphics for this item can be found"},frame:{$id:"#/properties/items/items/properties/frame",type:"integer",title:"Frame",description:"The specific frame in the tileset where the item is"}}}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://diss2020.com/player-profile.schema.json",type:"object",title:"Player Profile",description:"The affective profile of a player",additionalProperties:!1,properties:{anger:{$id:"#/properties/anger",type:"integer",title:"Anger",description:"The amount of anger that the player is feeling."},disgust:{$id:"#/properties/disgust",type:"integer",title:"Disgust",description:"The amount of disgust that the player is feeling."},fear:{$id:"#/properties/fear",type:"integer",title:"Fear",description:"The amount of fear that the player is feeling."},anxiety:{$id:"#/properties/anxiety",type:"integer",title:"Anxiety",description:"The amount of anxiety that the player is feeling."},sadness:{$id:"#/properties/sadness",type:"integer",title:"Sadness",description:"The amount of sadness that the player is feeling."},desire:{$id:"#/properties/desire",type:"integer",title:"Desire",description:"The amount of desire that the player is feeling."},relaxation:{$id:"#/properties/relaxation",type:"integer",title:"Relaxation",description:"The amount of relaxation that the player is feeling."},happiness:{$id:"#/properties/happiness",type:"integer",title:"Happiness",description:"The amount of happiness that the player is feeling."}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema",$id:"http://diss2020.com/tilesets.schema.json",type:"array",title:"Tilesets",description:"A list of all the tilesets used in the game",items:{type:"object",title:"Tileset",description:"An object description of a tileset.",required:["id","filename","frameWidth","frameHeight"],properties:{id:{type:"string",title:"Id",description:"The id of this tileset. Must be unique"},filename:{type:"string",title:"Filename",description:"The filename where this tileset is"},frameWidth:{type:"integer",title:"Frame width",description:"The width of each frame"},frameHeight:{type:"integer",title:"Frame Height",description:"The height of each frame"}}}}}])},1572:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r(57),o=r(1573),n={key:"Dialogue"},l=function(e){function t(){return e.call(this,n)||this}return a(t,e),t.prototype.init=function(e){this.dialogue=e.dialogue,this.emitter=e.emitter,this.spaceKey=this.input.keyboard.addKey(s.Input.Keyboard.KeyCodes.Z)},t.prototype.create=function(){this.dialogueBox=new o.DialogueBox(this,this.dialogue)},t.prototype.update=function(){this.dialogueBox.isDone()?void 0!==this.emitter&&this.emitter.emit("dialogueEnded"):s.Input.Keyboard.JustDown(this.spaceKey)&&this.dialogueBox.parseInput()},t}(s.Scene);t.DialogueScene=l},1573:function(e,t,r){"use strict";var i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=r(57),s=r(191),o=r(646),n=function(){function e(e,t){var r,a;this.fontFamily="MatchupPro",this.fontSize="30px",this.stroke="#000000",this.strokeThickness=2,this.scene=e,this.lines=t,this.currLine=0;try{for(var s=i(this.lines),o=s.next();!o.done;o=s.next()){var n=o.value;n.text="[stroke="+this.stroke+"]"+n.text+"[/stroke]"}}catch(e){r={error:e}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(r)throw r.error}}this.done=!1,this.create()}return e.prototype.create=function(){this.background=this.scene.add.image(320,360,"dialogue_box").setOrigin(.5,1),this.background.depth=9998,this.nameBox=this.scene.add.text(310,270,this.lines[this.currLine].author,{fontSize:this.fontSize,fontFamily:"EquipmentPro",maxLines:1,fixedWidth:500,color:"#e8c840",stroke:this.stroke,strokeThickness:this.strokeThickness}).setOrigin(.5,1),this.nameBox.depth=9999,this.textBox=this.createTextBox(320,360,{wrapWidth:500,fixedWidth:500,fixedHeight:70}).start(this.lines[this.currLine].text,20)},e.prototype.createTextBox=function(e,t,r){var i=a.Utils.Objects.GetValue,o=i(r,"wrapWidth",0),n=i(r,"fixedWidth",0),l=i(r,"fixedHeight",0),c=new s.TextBox(this.scene,{x:e,y:t,text:this.getBBcodeText(this.scene,o,n,l),action:this.getArrow(),space:{left:20,right:20,top:20,bottom:20,icon:10,text:10}}).setOrigin(.5,1).layout(),p=c.getElement("action");this.scene.tweens.add({targets:p,x:"+=10",ease:"Cubic",duration:700,repeat:-1,yoyo:!0});return c.on("pageend",(function(){var e=this.getElement("action").setVisible(!0);this.resetChildVisibleState(e)}),c),c},e.prototype.getBBcodeText=function(e,t,r,i){var a=new o.default(e,0,0,"",{fixedWidth:r,fixedHeight:i,fontFamily:this.fontFamily,fontSize:this.fontSize,strokeThickness:this.strokeThickness,stroke:this.stroke,wrap:{mode:"word",width:t},maxLines:2});return a.depth=9999,e.add.existing(a)},e.prototype.getArrow=function(){var e=this.scene.add.image(0,0,"dialogue_arrow").setVisible(!1);return e.depth=9999,e},e.prototype.isDialogueOver=function(){return this.currLine==this.lines.length-1},e.prototype.isDone=function(){return this.done},e.prototype.parseInput=function(){var e=this.textBox.getElement("action").setVisible(!1);this.textBox.resetChildVisibleState(e),this.textBox.isTyping?this.textBox.stop(!0):this.textBox.isLastPage?this.isDialogueOver()?this.done=!0:(this.currLine++,this.nameBox.text=this.lines[this.currLine].author,this.textBox.start(this.lines[this.currLine].text,20)):this.textBox.typeNextPage()},e.prototype.destroy=function(){this.background.destroy(),this.textBox.destroy(),this.nameBox.destroy()},e}();t.DialogueBox=n},1574:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r(57),o=r(191),n=r(646),l={key:"Introduction"},c=function(e){function t(){var t=e.call(this,l)||this;return t.fontFamily="MatchupPro",t.fontSize="30px",t.stroke="#000000",t.strokeThickness=2,t}return a(t,e),t.prototype.init=function(){this.interactKey=this.input.keyboard.addKey(s.Input.Keyboard.KeyCodes.Z),this.text="You are Clara, the daughter of a wealthy family.\nToday is Christmas and your parents are hosting a party with a lot of guests. As the eldest daughter of the family, it is expected that you attend the party and interact with the guests.\n\nHow is Clara going to handle this responsibility?",this.text=this.text="[stroke="+this.stroke+"]"+this.text+"[/stroke]"},t.prototype.create=function(){this.add.image(this.cameras.main.centerX,this.cameras.main.centerY,"dialogue_box_big").setOrigin(.5,.5);this.textBox=this.createTextBox(this.cameras.main.centerX,this.cameras.main.centerY,{wrapWidth:500,fixedWidth:500,fixedHeight:300}).start(this.text,50)},t.prototype.createTextBox=function(e,t,r){var i=s.Utils.Objects.GetValue,a=i(r,"wrapWidth",0),n=i(r,"fixedWidth",0),l=i(r,"fixedHeight",0),c=new o.TextBox(this,{x:e,y:t,text:this.getBBcodeText(this,a,n,l),action:this.getArrow(),space:{left:40,right:20,top:60,bottom:20,icon:10,text:60}}).setOrigin(.5,.5).layout();return c.on("pageend",(function(){var e=c.getElement("action").setVisible(!0);c.resetChildVisibleState(e),e.x-=30;this.tweens.add({targets:e,x:"+=10",ease:"Cubic",duration:700,repeat:-1,yoyo:!0})}),this),c},t.prototype.getBBcodeText=function(e,t,r,i){var a=new n.default(e,0,0,"",{fixedWidth:r,fixedHeight:i,fontFamily:this.fontFamily,fontSize:this.fontSize,wrap:{mode:"word",width:t},maxLines:14,strokeThickness:this.strokeThickness,stroke:this.stroke});return a.depth=9999,e.add.existing(a)},t.prototype.getArrow=function(){var e=this.add.image(0,0,"dialogue_arrow").setVisible(!1);return e.depth=9999,e},t.prototype.update=function(e,t){s.Input.Keyboard.JustDown(this.interactKey)&&(this.textBox.isTyping?this.textBox.stop(!0):this.textBox.isLastPage?this.cameras.main.fade(500,0,0,0,!1,(function(e,t){t>=1&&this.scene.start("Game")}),this):this.textBox.typeNextPage())},t}(s.Scene);t.IntroScene=c},1575:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r(57),o=r(191),n=r(643),l={key:"Tutorial"},c=function(e){function t(){var t=e.call(this,l)||this;return t.fontFamily="MatchupPro",t.fontSize="30px",t.stroke="#000000",t.strokeThickness=2,t}return a(t,e),t.prototype.init=function(){this.interactKey=this.input.keyboard.addKey(s.Input.Keyboard.KeyCodes.Z)},t.prototype.create=function(){this.add.image(this.cameras.main.centerX,this.cameras.main.centerY,"dialogue_box_big").setOrigin(.5,.5),this.createLabel(50,50,"Controls",{fontSize:"40px",fontFamily:"EquipmentPro",color:"#e8c840"}),this.anims.create({key:"walk_example",frames:this.anims.generateFrameNumbers("girls",{frames:[1,2,1,0]}),frameRate:5,repeat:-1}),this.add.sprite(50,120,"girls",0).setOrigin(0,.5).anims.play("walk_example"),this.createLabel(110,110,"Walking - Arrow Keys",{});var e=this.add.image(60,172,"dialogue_arrow");this.tweens.add({targets:e,x:"+=10",ease:"Cubic",duration:700,repeat:-1,yoyo:!0}),this.createLabel(110,160,"Go to next page - Z Key",{wrapWidth:500}),new n.ActionBox(this,"Talk",70,233,!1),this.createLabel(110,210,"Talk to other characters - Z Key",{wrapWidth:500}),this.createLabel(420,283,"Start Game",{fontFamily:"EquipmentPro",color:"#e8c840"});var t=this.add.image(560,300,"dialogue_arrow");this.tweens.add({targets:t,x:"+=10",ease:"Cubic",duration:700,repeat:-1,yoyo:!0})},t.prototype.createLabel=function(e,t,r,i){var a=s.Utils.Objects.GetValue,n=a(i,"wrapWidth",0),l=a(i,"fixedWidth",0),c=a(i,"fixedHeight",0),p=a(i,"fontFamily",this.fontFamily),h=a(i,"fontSize",this.fontSize),u=a(i,"color","#ffffff");return new o.Label(this,{x:e,y:t,text:this.getText(this,r,n,l,c,p,h,u)}).setOrigin(0,0).layout()},t.prototype.getText=function(e,t,r,i,a,s,o,n){return e.add.text(0,0,t,{fontSize:o,fontFamily:s,fixedWidth:i,fixedHeight:a,wordWrap:{width:r},color:n,stroke:this.stroke,strokeThickness:this.strokeThickness})},t.prototype.getArrow=function(){var e=this.add.image(0,0,"dialogue_arrow").setVisible(!1);return e.depth=9999,e},t.prototype.update=function(e,t){s.Input.Keyboard.JustDown(this.interactKey)&&this.scene.start("Introduction")},t}(s.Scene);t.TutorialScene=c},1576:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r(57),o=r(191),n={key:"End"},l=function(e){function t(){var t=e.call(this,n)||this;return t.fontFamily="MatchupPro",t.fontSize="30px",t.stroke="#000000",t.strokeThickness=2,t.sentEvent=!1,t}return a(t,e),t.prototype.init=function(){this.doneDomElem=this.registry.get("doneDomElem"),this.endEvent=new Event("endGame")},t.prototype.create=function(){this.createLabel(this.cameras.main.centerX,this.cameras.main.centerY-30,"The End",{fontSize:"50px",fontFamily:"EquipmentPro",color:"#e8c840",align:"center"}),this.createLabel(this.cameras.main.centerX,this.cameras.main.centerY+10,"Thank you for playing!",{align:"center",fontSize:"40px"}),this.createLabel(this.cameras.main.centerX,320,"Please press the Next button to continue to the next questionnaire",{align:"center",wrapWidth:500,fontSize:"25px"}),this.cameras.main.fadeFrom(500)},t.prototype.createLabel=function(e,t,r,i){var a=s.Utils.Objects.GetValue,n=a(i,"wrapWidth",0),l=a(i,"fixedWidth",0),c=a(i,"fixedHeight",0),p=a(i,"fontFamily",this.fontFamily),h=a(i,"fontSize",this.fontSize),u=a(i,"color","#ffffff"),d=a(i,"align","left"),f=new o.Label(this,{x:e,y:t,text:this.getText(this,r,n,l,c,p,h,u,d)});return"center"==d?f.setOrigin(.5,.5):"right"==d?f.setOrigin(1,.5):f.setOrigin(0,.5),f.layout(),f},t.prototype.getText=function(e,t,r,i,a,s,o,n,l){return e.add.text(0,0,t,{fontSize:o,fontFamily:s,fixedWidth:i,fixedHeight:a,wordWrap:{width:r},color:n,stroke:this.stroke,strokeThickness:this.strokeThickness,align:l})},t.prototype.update=function(e,t){this.sentEvent||(this.sentEvent=!0,this.doneDomElem.dispatchEvent(this.endEvent))},t}(s.Scene);t.EndScene=l},235:function(e,t,r){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=r(57),n=r(1559),l={key:"Game"},c=function(e){function t(){var t=e.call(this,l)||this;return t.obstacles=[],t.isGameEnded=!1,t}return a(t,e),t.prototype.init=function(){var e=this.registry.get("story"),t=this.registry.get("playerType");this.storyManager=new n.StoryManager(this,e,t)},t.prototype.create=function(){var e=this.storyManager.getCurrScene();this.map=this.initMap(e),t.cursors=this.input.keyboard.createCursorKeys(),t.interactKey=this.input.keyboard.addKey(o.Input.Keyboard.KeyCodes.Z),this.storyManager.start(),this.cameras.main.setBounds(0,0,this.map.widthInPixels,this.map.heightInPixels),this.cameras.main.roundPixels=!0,this.cameras.main.fadeFrom(500)},t.prototype.update=function(e,t){if(!this.isGameEnded){if(this.storyManager.isDone())return this.isGameEnded=!0,void this.cameras.main.fade(500,0,0,0,!0,(function(e,t){t>=1&&this.scene.start("End")}),this);var r=this.parseUserInput();this.storyManager.act(e,t,r)}},t.prototype.setActorCollisionsWithMap=function(e){var t,r;try{for(var i=s(this.obstacles),a=i.next();!a.done;a=i.next()){var o=a.value;e.setCollisionWith(o,this)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.getMap=function(){return this.map},t.prototype.parseUserInput=function(){var e=[];return o.Input.Keyboard.JustDown(t.interactKey)&&e.push(t.interactKey),t.cursors.left.isDown&&e.push(t.cursors.left),t.cursors.right.isDown&&e.push(t.cursors.right),t.cursors.up.isDown&&e.push(t.cursors.up),t.cursors.down.isDown&&e.push(t.cursors.down),e},t.prototype.initMap=function(e){var r,i,a,o,n=this.make.tilemap({key:e.name}),l=[];try{for(var c=s(n.tilesets),p=c.next();!p.done;p=c.next()){var h=p.value;l.push(n.addTilesetImage(h.name))}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}try{for(var u=s(n.layers),d=u.next();!d.done;d=u.next()){var f=d.value,m=f.properties.find((function(e){return"depth"===e.name})).value;m+=m>0?t.MAX_DEPTH+1:t.MIN_DEPTH-1;var v=f.properties.find((function(e){return"collidable"===e.name})).value,y=n.createStaticLayer(f.name,l).setDepth(m);v&&(y.setCollisionByExclusion([-1]),this.obstacles.push(y))}}catch(e){a={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}return n},t.MAX_DEPTH=128,t.MIN_DEPTH=0,t}(o.Scene);t.GameScene=c},236:function(e,t,r){"use strict";var i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=r(1579),s=r(641),o=r(1561),n=r(235),l=function(){function e(e,t,r,i,a){if(this.velocity=80,this.id=i.id,this.name=i.name,!a){var s=o.toRealMapCoordinates(t,r,e.getMap());t=s.x,r=s.y}this.sprite=e.physics.add.sprite(t,r,i.tilesetId,i.defaultFrame).setOrigin(.5,1),this.initBody(i),this.createAnimations(i.tilesetId,i.animations,e)}return e.prototype.initBody=function(e){var t={width:e.body.width,height:e.body.height,anchor:e.body.anchor};if(s.isArcadeBody(this.sprite.body)){var r=this.sprite.body.width,i=this.sprite.body.height,a=this.sprite.body.width*t.width*.01,o=this.sprite.body.height*t.height*.01,n=t.anchor.split("-")[0],l=t.anchor.split("-")[1],c=0,p=0;switch(n){case"center":c=(r-a)/2;break;case"left":c=0;break;case"right":c=r-a}switch(l){case"center":p=(i-o)/2;break;case"bottom":p=i-o;break;case"top":p=0}this.sprite.body.setSize(a,o),this.sprite.body.setOffset(c,p)}},e.prototype.createAnimations=function(e,t,r){var a,s;try{for(var o=i(t),n=o.next();!n.done;n=o.next()){var l=n.value;r.anims.create({key:this.id+"_"+l.key,frames:r.anims.generateFrameNumbers(e,{frames:l.frames}),frameRate:l.frameRate,repeat:l.repeat})}}catch(e){a={error:e}}finally{try{n&&!n.done&&(s=o.return)&&s.call(o)}finally{if(a)throw a.error}}},e.prototype.getAnimationKey=function(e){return this.id+"_"+e},e.prototype.playAnimation=function(e){this.sprite.anims.play(this.getAnimationKey(e),!0)},e.prototype.stopAnimation=function(){this.sprite.anims.stop()},e.prototype.getId=function(){return this.id},e.prototype.destroy=function(){this.sprite.destroy()},e.prototype.getCameraToFollow=function(e){e.cameras.main.startFollow(this.sprite)},e.prototype.getName=function(){return this.name},e.prototype.setCollisionWith=function(e,t){s.isActor(e)?t.physics.add.collider(e.sprite,this.sprite):s.isStaticMapLayer(e)&&t.physics.add.collider(e,this.sprite)},e.prototype.isOverlappingWithObject=function(e,t){return e.physics.overlap(t,this.sprite)},e.prototype.moveAuto=function(e,t,r,i){var s=new a.default(this.sprite,{speed:this.velocity,rotateToTarget:!1});s.on("complete",(function(e,t){i.emit("stopWalking")}));var n=o.toTileMapCoordinates(this.sprite.x,this.sprite.y,e.getMap());n.x+=t,n.y+=r;var l=o.toRealMapCoordinates(n.x,n.y,e.getMap());s.moveTo(l.x,l.y)},e.prototype.getX=function(){return this.sprite.x},e.prototype.getY=function(){return this.sprite.y},e.prototype.setDepth=function(e){e<n.GameScene.MIN_DEPTH?e=n.GameScene.MIN_DEPTH:e>n.GameScene.MAX_DEPTH&&(e=n.GameScene.MAX_DEPTH),this.sprite.setDepth(e)},e}();t.Actor=l},355:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uiPath="./assets/ui/",t.fontsPath="./assets/fonts/",t.storyPath="./assets/story/",t.eventsPath="./assets/story/event/",t.dialoguePath="./assets/story/dialogue/",t.mapsPath="./assets/map/",t.mapTilesPath="./assets/mapTiles/",t.tilesetPath="./assets/tileset/",t.getAssetIdFromPath=function(e){var t=-1===e.lastIndexOf("/")?0:e.lastIndexOf("/");return e.slice(t,e.lastIndexOf("."))},t.getFilenameFromPath=function(e){var t=-1===e.lastIndexOf("/")?0:e.lastIndexOf("/");return e.slice(t)}},640:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.jsonObj=e.cache.json.get(t),this.scene=e,this.done=!1}return e.prototype.isDone=function(){return this.done},e}();t.EventManager=i},641:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(57),a=r(236);t.isArcadeBody=function(e){return e instanceof i.Physics.Arcade.Body},t.isWebGLRenderer=function(e){return e instanceof i.Renderer.WebGL.WebGLRenderer},t.isActor=function(e){return e instanceof a.Actor},t.isStaticMapLayer=function(e){return e instanceof i.Tilemaps.StaticTilemapLayer}},642:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.scene=e,this.done=!1,this.actor=t}return e.prototype.isDone=function(){return this.done},e.prototype.getActor=function(){return this.actor},e}();t.Action=i},643:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(191),a=function(){function e(e,t,r,i,a){this.fontFamily="MatchupPro",this.fontSize="25px",this.stroke="#000000",this.strokeThickness=2,e.anims.create({key:"zKeyAnimation",frames:e.anims.generateFrameNumbers("zkey",{frames:[0,1]}),frameRate:2,repeat:-1}),this.scene=e,this.action=t,this.textLabel=this.createLabel(r,i),a&&this.hide()}return e.prototype.hide=function(){var e=this.scene;e.rexUI.hide(this.textLabel),e.rexUI.getTopmostSizer(this.textLabel).layout()},e.prototype.show=function(){var e=this.scene;e.rexUI.show(this.textLabel),e.rexUI.getTopmostSizer(this.textLabel).layout()},e.prototype.destroy=function(){this.textLabel.destroy()},e.prototype.createLabel=function(e,t){return new i.Label(this.scene,{x:e,y:t,height:20,text:this.getActionText(this.scene,this.action),icon:this.getIcon(this.scene)}).setOrigin(.5,1).layout()},e.prototype.getActionText=function(e,t){var r=e.add.text(0,0,t,{fontFamily:this.fontFamily,fontSize:this.fontSize,strokeThickness:this.strokeThickness,stroke:this.stroke,maxLines:1});return r.depth=9999,r},e.prototype.getIcon=function(e){var t=e.add.sprite(0,0,"zkey",0);return t.anims.play("zKeyAnimation"),t.depth=9999,t},e}();t.ActionBox=a},644:function(e,t,r){"use strict";var i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,a,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var s=r(1568);function o(e){var t,r,s={};try{for(var o=i(e),n=o.next();!n.done;n=o.next()){var l=a(n.value,2),c=l[0],p=l[1];s[c]=p}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return s.true=!0,s.false=!1,s}t.boolean=function(e,t){var r=o(t);try{return!!s.compileExpression(e)(r)}catch(e){return e}},t.number=function(e,t){var r=o(t);try{return+s.compileExpression(e)(r)}catch(e){return e}}},645:function(e,t,r){"use strict";var i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,a,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return o};function a(e,t){var r={action:e,timestamp:new Date};return t&&(r.args=t),JSON.stringify(r)}function s(e,t){e.registry.get("logs").push(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.initLogging=function(e){e.registry.set("logs",[])},t.startGame=function(e){s(e,a("Game START"))},t.endGame=function(e){s(e,a("Game END"))},t.startEvent=function(e,t){s(e,a(t.type.toUpperCase()+" event "+t.name+" START",{type:t.type,name:t.name}))},t.endEvent=function(e,t){s(e,a(t.type.toUpperCase()+" event "+t.name+" END",{type:t.type,name:t.name}))},t.flagChange=function(e,t){var r;s(e,a("Flag changes",{currFlags:(r=t,Array.from(r).reduce((function(e,t){var r=i(t,2),a=r[0],s=r[1];return e[a]=s,e}),{}))}))}},653:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(654))},654:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=r(57),s=r(1578),o=r(1577),n=r(235),l=r(1570),c=r(1572),p=r(1574),h=r(1575),u=r(1576),d={type:a.AUTO,scale:{parent:"content",mode:a.Scale.FIT,width:640,height:360,min:{width:640,height:360}},render:{pixelArt:!0},physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[l.BootScene,n.GameScene,c.DialogueScene,p.IntroScene,h.TutorialScene,u.EndScene],plugins:{scene:[{key:"rexUI",plugin:o.default,mapping:"rexUI"}],global:[{key:"rexWebfontLoader",plugin:s.default,start:!0}]}};t.newGame=function(e){void 0===e&&(e={playerProfile:{}}),d.scale.parent=e.parent?e.parent:d.scale.parent,i=new a.Game(d);var t=e.playerProfile?e.playerProfile:{};i.registry.set("doneDomElem",e.doneDomElem),i.registry.set("playerType",t)},t.getRatio=function(){return 640/360},t.endGame=function(){i.scene.getScene("Game").plugins.removeScenePlugin("rexUI"),i.destroy(!1)},t.getLogs=function(){if(i){var e=i.registry.get("logs");return e||[]}return[]}}});
//# sourceMappingURL=app.bundle.js.map